[2025-01-17 06:07:37,331][INFO] 
===== FNN_small-0.1-200-small-2025-01-17-06-07-37 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 1e-05
  lr: 10
  batch_size: 50
  min_epochs: 25
  max_epochs: 25
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: FNN_small
  no_repair: False
  repair_number: 200
  repair_batchsize: 1
  patch_size: small
  label_repaired: False
  repair_radius: 0.1
  divided_repair: 2
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x79ca14ef4820>
  reset_params: False
  train_datasize: 10000
  test_datasize: 2000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 200
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x79ca14ef4e50>
===== end of FNN_small-0.1-200-small-2025-01-17-06-07-37 configuration =====

[2025-01-17 06:07:37,331][INFO] ===== start repair ======
[2025-01-17 06:07:37,331][INFO] For pgd attack net
[2025-01-17 06:07:37,520][INFO] --Test repair set accuracy 0.0
[2025-01-17 06:07:37,521][INFO] --Test original set accuracy 0.995
[2025-01-17 06:07:37,521][INFO] --Test test set accuracy 0.9658
[2025-01-17 06:07:37,522][INFO] --Test attack test set accuracy 0.0
[2025-01-17 06:07:37,522][INFO] --Test train set accuracy 0.9928
[2025-01-17 06:07:40,389][INFO] --small patch network: Mnist_patch_model_small(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (classifier): Sequential(
    (0): Linear(in_features=784, out_features=10, bias=True)
  )
)
[2025-01-17 06:07:40,446][INFO] [0m 0s (0.037 seconds)] Start repair part 0: 0
[2025-01-17 06:07:40,446][INFO] [0m 0s (0.037 seconds)] After epoch 0:
[2025-01-17 06:07:40,446][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:40,446][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:40,446][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:40,446][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:40,608][INFO] min loss 162459.59375, max loss 396080.125.
[2025-01-17 06:07:40,650][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:40,650][INFO] repair set accuracy 0.01.
[2025-01-17 06:07:40,650][INFO] attacked test set accuracy 0.013.
[2025-01-17 06:07:40,650][INFO] 
[0m 0s (0.242 seconds)] Starting epoch 1:
[2025-01-17 06:07:41,054][INFO] [0m 0s (0.645 seconds)] After epoch 1:
[2025-01-17 06:07:41,054][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:41,054][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:41,054][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:41,054][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:41,200][INFO] min loss 158055.71875, max loss 395091.9375.
[2025-01-17 06:07:41,242][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:41,244][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:41,244][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:41,244][INFO] 
[0m 0s (0.836 seconds)] Starting epoch 2:
[2025-01-17 06:07:41,680][INFO] [0m 1s (1.272 seconds)] After epoch 2:
[2025-01-17 06:07:41,681][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:41,681][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:41,681][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:41,681][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:41,836][INFO] min loss 135638.65625, max loss 386418.1875.
[2025-01-17 06:07:41,878][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:41,878][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:41,878][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:41,878][INFO] 
[0m 1s (1.470 seconds)] Starting epoch 3:
[2025-01-17 06:07:42,287][INFO] [0m 1s (1.878 seconds)] After epoch 3:
[2025-01-17 06:07:42,287][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:42,287][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:42,287][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:42,287][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:42,434][INFO] min loss 103965.3359375, max loss 373700.0625.
[2025-01-17 06:07:42,476][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:42,476][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:42,476][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:42,476][INFO] 
[0m 2s (2.068 seconds)] Starting epoch 4:
[2025-01-17 06:07:42,902][INFO] [0m 2s (2.494 seconds)] After epoch 4:
[2025-01-17 06:07:42,903][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:42,903][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:42,903][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:42,903][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:43,058][INFO] min loss 73125.515625, max loss 363993.4375.
[2025-01-17 06:07:43,100][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:43,100][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:43,100][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:43,100][INFO] 
[0m 2s (2.692 seconds)] Starting epoch 5:
[2025-01-17 06:07:43,509][INFO] [0m 3s (3.100 seconds)] After epoch 5:
[2025-01-17 06:07:43,509][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:43,509][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:43,509][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:43,509][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:43,655][INFO] min loss 46796.90625, max loss 358196.3125.
[2025-01-17 06:07:43,697][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:43,697][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:43,698][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:43,698][INFO] 
[0m 3s (3.289 seconds)] Starting epoch 6:
[2025-01-17 06:07:44,106][INFO] [0m 3s (3.698 seconds)] After epoch 6:
[2025-01-17 06:07:44,106][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:44,106][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:44,106][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:44,106][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:44,253][INFO] min loss 18654.40234375, max loss 349524.625.
[2025-01-17 06:07:44,295][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:44,296][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:44,296][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:44,296][INFO] 
[0m 3s (3.887 seconds)] Starting epoch 7:
[2025-01-17 06:07:44,727][INFO] [0m 4s (4.318 seconds)] After epoch 7:
[2025-01-17 06:07:44,727][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:44,727][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:44,727][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:44,727][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:44,882][INFO] min loss 3166.203125, max loss 339119.09375.
[2025-01-17 06:07:44,924][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:44,924][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:44,925][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:44,925][INFO] 
[0m 4s (4.516 seconds)] Starting epoch 8:
[2025-01-17 06:07:45,353][INFO] [0m 4s (4.944 seconds)] After epoch 8:
[2025-01-17 06:07:45,353][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:45,353][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:45,353][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:45,353][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:45,509][INFO] min loss 0.0, max loss 331676.3125.
[2025-01-17 06:07:45,551][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:45,551][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:45,551][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:45,551][INFO] 
[0m 5s (5.143 seconds)] Starting epoch 9:
[2025-01-17 06:07:45,977][INFO] [0m 5s (5.568 seconds)] After epoch 9:
[2025-01-17 06:07:45,977][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:45,977][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:45,977][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:45,977][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:46,133][INFO] min loss 0.0, max loss 324921.9375.
[2025-01-17 06:07:46,174][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:46,174][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:46,174][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:46,250][INFO] Accuracy at every epoch: [0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658]
[2025-01-17 06:07:46,250][INFO] After 9 epochs / 0m 5s (5.766 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2025-01-17 06:07:46,288][INFO] [0m 5s (5.879 seconds)] Start repair part 1: 100
[2025-01-17 06:07:46,288][INFO] [0m 5s (5.880 seconds)] After epoch 0:
[2025-01-17 06:07:46,288][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:46,288][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:46,288][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:46,288][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:46,433][INFO] min loss 175991.53125, max loss 395144.53125.
[2025-01-17 06:07:46,475][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:46,475][INFO] repair set accuracy 0.0.
[2025-01-17 06:07:46,475][INFO] attacked test set accuracy 0.001.
[2025-01-17 06:07:46,475][INFO] 
[0m 6s (6.067 seconds)] Starting epoch 1:
[2025-01-17 06:07:46,900][INFO] [0m 6s (6.491 seconds)] After epoch 1:
[2025-01-17 06:07:46,900][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:46,900][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:46,900][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:46,900][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:47,047][INFO] min loss 157603.546875, max loss 384322.5.
[2025-01-17 06:07:47,088][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:47,089][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:47,089][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:47,089][INFO] 
[0m 6s (6.680 seconds)] Starting epoch 2:
[2025-01-17 06:07:47,511][INFO] [0m 7s (7.102 seconds)] After epoch 2:
[2025-01-17 06:07:47,511][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:47,511][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:47,511][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:47,511][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:47,657][INFO] min loss 128859.484375, max loss 369291.375.
[2025-01-17 06:07:47,698][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:47,699][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:47,699][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:47,699][INFO] 
[0m 7s (7.290 seconds)] Starting epoch 3:
[2025-01-17 06:07:48,122][INFO] [0m 7s (7.713 seconds)] After epoch 3:
[2025-01-17 06:07:48,122][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:48,122][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:48,122][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:48,122][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:48,269][INFO] min loss 96757.375, max loss 350376.3125.
[2025-01-17 06:07:48,310][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:48,310][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:48,310][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:48,310][INFO] 
[0m 7s (7.902 seconds)] Starting epoch 4:
[2025-01-17 06:07:48,733][INFO] [0m 8s (8.325 seconds)] After epoch 4:
[2025-01-17 06:07:48,733][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:48,733][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:48,734][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:48,734][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:48,882][INFO] min loss 65814.09375, max loss 334471.125.
[2025-01-17 06:07:48,925][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:48,925][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:48,925][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:48,925][INFO] 
[0m 8s (8.516 seconds)] Starting epoch 5:
[2025-01-17 06:07:49,379][INFO] [0m 8s (8.971 seconds)] After epoch 5:
[2025-01-17 06:07:49,379][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:49,380][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:49,380][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:49,380][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:49,533][INFO] min loss 39511.1796875, max loss 322206.46875.
[2025-01-17 06:07:49,575][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:49,575][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:49,575][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:49,575][INFO] 
[0m 9s (9.167 seconds)] Starting epoch 6:
[2025-01-17 06:07:50,039][INFO] [0m 9s (9.630 seconds)] After epoch 6:
[2025-01-17 06:07:50,039][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:50,039][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:50,039][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:50,039][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:50,193][INFO] min loss 11332.2109375, max loss 307191.90625.
[2025-01-17 06:07:50,235][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:50,235][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:50,235][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:50,235][INFO] 
[0m 9s (9.827 seconds)] Starting epoch 7:
[2025-01-17 06:07:50,706][INFO] [0m 10s (10.297 seconds)] After epoch 7:
[2025-01-17 06:07:50,706][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:50,706][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:50,706][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:50,706][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:50,860][INFO] min loss 254.20965576171875, max loss 290506.03125.
[2025-01-17 06:07:50,902][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:50,902][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:50,902][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:50,902][INFO] 
[0m 10s (10.494 seconds)] Starting epoch 8:
[2025-01-17 06:07:51,328][INFO] [0m 10s (10.920 seconds)] After epoch 8:
[2025-01-17 06:07:51,328][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:51,329][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:51,329][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:51,329][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:51,475][INFO] min loss 0.0, max loss 276665.625.
[2025-01-17 06:07:51,516][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:51,516][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:51,516][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:51,516][INFO] 
[0m 11s (11.108 seconds)] Starting epoch 9:
[2025-01-17 06:07:51,943][INFO] [0m 11s (11.534 seconds)] After epoch 9:
[2025-01-17 06:07:51,943][INFO] Loaded 100 points for repair.
[2025-01-17 06:07:51,943][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:07:51,943][INFO] Loaded 10000 points for training.
[2025-01-17 06:07:51,943][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:07:52,091][INFO] min loss 0.0, max loss 263466.3125.
[2025-01-17 06:07:52,133][INFO] Test set accuracy 0.9658.
[2025-01-17 06:07:52,133][INFO] repair set accuracy 1.0.
[2025-01-17 06:07:52,133][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:07:52,211][INFO] Accuracy at every epoch: [0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658]
[2025-01-17 06:07:52,211][INFO] After 9 epochs / 0m 11s (11.725 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2025-01-17 06:07:52,212][INFO] final test
[2025-01-17 06:07:52,217][INFO] --Test set accuracy 0.9658
[2025-01-17 06:07:52,249][INFO] --Test repair set accuracy 1.0
[2025-01-17 06:07:52,282][INFO] --Test attack test set accuracy 1.0
[2025-01-17 06:07:52,282][INFO] training time 11.873540487140417s
[2025-01-17 06:07:52,291][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2025-01-17 06:07:52,291][INFO] tensor([ 9.0000, 11.7246,  0.0000,  0.9658])
[2025-01-17 06:07:52,292][INFO] Total Cost Time: 14.961550498381257s.



