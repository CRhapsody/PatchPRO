[2025-01-17 06:11:03,186][INFO] 
===== FNN_small-0.3-100-small-2025-01-17-06-11-03 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 3e-05
  lr: 10
  batch_size: 50
  min_epochs: 25
  max_epochs: 25
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: FNN_small
  no_repair: False
  repair_number: 100
  repair_batchsize: 1
  patch_size: small
  label_repaired: False
  repair_radius: 0.3
  divided_repair: 1
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x79ca14ef4790>
  reset_params: False
  train_datasize: 10000
  test_datasize: 1000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 100
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x79ca14ef4dc0>
===== end of FNN_small-0.3-100-small-2025-01-17-06-11-03 configuration =====

[2025-01-17 06:11:03,186][INFO] ===== start repair ======
[2025-01-17 06:11:03,186][INFO] For pgd attack net
[2025-01-17 06:11:03,375][INFO] --Test repair set accuracy 0.0
[2025-01-17 06:11:03,376][INFO] --Test original set accuracy 0.99
[2025-01-17 06:11:03,376][INFO] --Test test set accuracy 0.9658
[2025-01-17 06:11:03,377][INFO] --Test attack test set accuracy 0.0
[2025-01-17 06:11:03,377][INFO] --Test train set accuracy 0.9928
[2025-01-17 06:11:04,146][INFO] --small patch network: Mnist_patch_model_small(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (classifier): Sequential(
    (0): Linear(in_features=784, out_features=10, bias=True)
  )
)
[2025-01-17 06:11:04,184][INFO] [0m 0s (0.028 seconds)] Start repair part 0: 0
[2025-01-17 06:11:04,184][INFO] [0m 0s (0.028 seconds)] After epoch 0:
[2025-01-17 06:11:04,184][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:04,184][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:04,184][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:04,184][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:04,325][INFO] min loss 530433.125, max loss 1188016.25.
[2025-01-17 06:11:04,360][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:04,360][INFO] repair set accuracy 0.0.
[2025-01-17 06:11:04,360][INFO] attacked test set accuracy 0.0.
[2025-01-17 06:11:04,360][INFO] 
[0m 0s (0.204 seconds)] Starting epoch 1:
[2025-01-17 06:11:04,691][INFO] [0m 0s (0.535 seconds)] After epoch 1:
[2025-01-17 06:11:04,691][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:04,691][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:04,691][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:04,692][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:04,833][INFO] min loss 548875.125, max loss 1205060.0.
[2025-01-17 06:11:04,869][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:04,869][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:04,869][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:04,869][INFO] 
[0m 0s (0.713 seconds)] Starting epoch 2:
[2025-01-17 06:11:05,204][INFO] [0m 1s (1.048 seconds)] After epoch 2:
[2025-01-17 06:11:05,204][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:05,204][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:05,204][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:05,204][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:05,346][INFO] min loss 531171.4375, max loss 1197406.5.
[2025-01-17 06:11:05,382][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:05,382][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:05,382][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:05,382][INFO] 
[0m 1s (1.226 seconds)] Starting epoch 3:
[2025-01-17 06:11:05,719][INFO] [0m 1s (1.563 seconds)] After epoch 3:
[2025-01-17 06:11:05,719][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:05,719][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:05,719][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:05,719][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:05,861][INFO] min loss 502433.0625, max loss 1177719.625.
[2025-01-17 06:11:05,897][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:05,897][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:05,897][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:05,897][INFO] 
[0m 1s (1.741 seconds)] Starting epoch 4:
[2025-01-17 06:11:06,234][INFO] [0m 2s (2.078 seconds)] After epoch 4:
[2025-01-17 06:11:06,234][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:06,234][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:06,234][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:06,234][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:06,376][INFO] min loss 474168.9375, max loss 1167244.625.
[2025-01-17 06:11:06,412][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:06,412][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:06,412][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:06,412][INFO] 
[0m 2s (2.256 seconds)] Starting epoch 5:
[2025-01-17 06:11:06,749][INFO] [0m 2s (2.593 seconds)] After epoch 5:
[2025-01-17 06:11:06,749][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:06,749][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:06,749][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:06,750][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:06,891][INFO] min loss 459829.1875, max loss 1168789.0.
[2025-01-17 06:11:06,927][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:06,927][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:06,927][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:06,927][INFO] 
[0m 2s (2.771 seconds)] Starting epoch 6:
[2025-01-17 06:11:07,264][INFO] [0m 3s (3.108 seconds)] After epoch 6:
[2025-01-17 06:11:07,265][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:07,265][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:07,265][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:07,265][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:07,407][INFO] min loss 437868.15625, max loss 1161599.25.
[2025-01-17 06:11:07,442][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:07,443][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:07,443][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:07,443][INFO] 
[0m 3s (3.287 seconds)] Starting epoch 7:
[2025-01-17 06:11:07,781][INFO] [0m 3s (3.625 seconds)] After epoch 7:
[2025-01-17 06:11:07,781][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:07,781][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:07,781][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:07,781][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:07,924][INFO] min loss 411895.90625, max loss 1149058.5.
[2025-01-17 06:11:07,960][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:07,960][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:07,960][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:07,961][INFO] 
[0m 3s (3.805 seconds)] Starting epoch 8:
[2025-01-17 06:11:08,362][INFO] [0m 4s (4.206 seconds)] After epoch 8:
[2025-01-17 06:11:08,363][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:08,363][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:08,363][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:08,363][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:08,504][INFO] min loss 394660.75, max loss 1145410.5.
[2025-01-17 06:11:08,541][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:08,541][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:08,541][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:08,541][INFO] 
[0m 4s (4.385 seconds)] Starting epoch 9:
[2025-01-17 06:11:08,943][INFO] [0m 4s (4.787 seconds)] After epoch 9:
[2025-01-17 06:11:08,943][INFO] Loaded 100 points for repair.
[2025-01-17 06:11:08,943][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:11:08,943][INFO] Loaded 10000 points for training.
[2025-01-17 06:11:08,943][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:11:09,085][INFO] min loss 376430.65625, max loss 1144041.875.
[2025-01-17 06:11:09,121][INFO] Test set accuracy 0.9658.
[2025-01-17 06:11:09,121][INFO] repair set accuracy 1.0.
[2025-01-17 06:11:09,121][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:11:09,156][INFO] Accuracy at every epoch: [0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658]
[2025-01-17 06:11:09,156][INFO] After 9 epochs / 0m 4s (4.965 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2025-01-17 06:11:09,157][INFO] final test
[2025-01-17 06:11:09,160][INFO] --Test set accuracy 0.9658
[2025-01-17 06:11:09,176][INFO] --Test repair set accuracy 1.0
[2025-01-17 06:11:09,192][INFO] --Test attack test set accuracy 1.0
[2025-01-17 06:11:09,193][INFO] training time 5.036570444703102s
[2025-01-17 06:11:09,199][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2025-01-17 06:11:09,199][INFO] tensor([9.0000, 4.9654, 0.0000, 0.9658])
[2025-01-17 06:11:09,202][INFO] Total Cost Time: 6.015925879590213s.



