[2025-01-17 06:29:52,952][INFO] 
===== CNN_small-0.3-200-small-2025-01-17-06-29-52 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 3e-05
  lr: 10
  batch_size: 50
  min_epochs: 25
  max_epochs: 25
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: CNN_small
  no_repair: False
  repair_number: 200
  repair_batchsize: 1
  patch_size: small
  label_repaired: False
  repair_radius: 0.3
  divided_repair: 2
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x79ca14ef4820>
  reset_params: False
  train_datasize: 10000
  test_datasize: 2000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 200
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x79ca14ef4790>
===== end of CNN_small-0.3-200-small-2025-01-17-06-29-52 configuration =====

[2025-01-17 06:29:52,952][INFO] ===== start repair ======
[2025-01-17 06:29:52,953][INFO] For pgd attack net
[2025-01-17 06:29:53,143][INFO] --Test repair set accuracy 0.0
[2025-01-17 06:29:53,144][INFO] --Test original set accuracy 0.995
[2025-01-17 06:29:53,145][INFO] --Test test set accuracy 0.9827
[2025-01-17 06:29:53,145][INFO] --Test attack test set accuracy 0.0
[2025-01-17 06:29:53,147][INFO] --Test train set accuracy 0.9927
[2025-01-17 06:29:56,035][INFO] --small patch network: Mnist_patch_model_small(
  (flatten): Flatten(start_dim=1, end_dim=-1)
  (classifier): Sequential(
    (0): Linear(in_features=784, out_features=10, bias=True)
  )
)
[2025-01-17 06:29:56,156][INFO] [0m 0s (0.102 seconds)] Start repair part 0: 0
[2025-01-17 06:29:56,156][INFO] [0m 0s (0.102 seconds)] After epoch 0:
[2025-01-17 06:29:56,156][INFO] Loaded 100 points for repair.
[2025-01-17 06:29:56,156][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:29:56,157][INFO] Loaded 10000 points for training.
[2025-01-17 06:29:56,157][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:29:56,365][INFO] min loss 10865.90234375, max loss 13596.333984375.
[2025-01-17 06:29:56,408][INFO] Test set accuracy 0.9827.
[2025-01-17 06:29:56,408][INFO] repair set accuracy 0.0.
[2025-01-17 06:29:56,408][INFO] attacked test set accuracy 0.001.
[2025-01-17 06:29:56,408][INFO] 
[0m 0s (0.353 seconds)] Starting epoch 1:
[2025-01-17 06:29:56,741][INFO] [0m 0s (0.686 seconds)] After epoch 1:
[2025-01-17 06:29:56,741][INFO] Loaded 100 points for repair.
[2025-01-17 06:29:56,741][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:29:56,741][INFO] Loaded 10000 points for training.
[2025-01-17 06:29:56,741][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:29:56,952][INFO] min loss 19255.306640625, max loss 44434.4375.
[2025-01-17 06:29:56,994][INFO] Test set accuracy 0.9827.
[2025-01-17 06:29:56,994][INFO] repair set accuracy 1.0.
[2025-01-17 06:29:56,995][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:29:56,995][INFO] 
[0m 0s (0.940 seconds)] Starting epoch 2:
[2025-01-17 06:29:57,350][INFO] [0m 1s (1.296 seconds)] After epoch 2:
[2025-01-17 06:29:57,350][INFO] Loaded 100 points for repair.
[2025-01-17 06:29:57,350][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:29:57,350][INFO] Loaded 10000 points for training.
[2025-01-17 06:29:57,351][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:29:57,561][INFO] min loss 0.0, max loss 40220.984375.
[2025-01-17 06:29:57,603][INFO] Test set accuracy 0.9827.
[2025-01-17 06:29:57,604][INFO] repair set accuracy 1.0.
[2025-01-17 06:29:57,604][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:29:57,604][INFO] 
[0m 1s (1.549 seconds)] Starting epoch 3:
[2025-01-17 06:29:57,942][INFO] [0m 1s (1.888 seconds)] After epoch 3:
[2025-01-17 06:29:57,942][INFO] Loaded 100 points for repair.
[2025-01-17 06:29:57,942][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:29:57,943][INFO] Loaded 10000 points for training.
[2025-01-17 06:29:57,943][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:29:58,153][INFO] min loss 0.0, max loss 23010.232421875.
[2025-01-17 06:29:58,196][INFO] Test set accuracy 0.9827.
[2025-01-17 06:29:58,196][INFO] repair set accuracy 1.0.
[2025-01-17 06:29:58,196][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:29:58,196][INFO] 
[0m 2s (2.142 seconds)] Starting epoch 4:
[2025-01-17 06:29:58,535][INFO] [0m 2s (2.481 seconds)] After epoch 4:
[2025-01-17 06:29:58,536][INFO] Loaded 100 points for repair.
[2025-01-17 06:29:58,536][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:29:58,536][INFO] Loaded 10000 points for training.
[2025-01-17 06:29:58,536][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:29:58,747][INFO] min loss 0.0, max loss 6465.6142578125.
[2025-01-17 06:29:58,789][INFO] Test set accuracy 0.9827.
[2025-01-17 06:29:58,789][INFO] repair set accuracy 1.0.
[2025-01-17 06:29:58,789][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:29:58,789][INFO] 
[0m 2s (2.735 seconds)] Starting epoch 5:
[2025-01-17 06:29:59,129][INFO] [0m 3s (3.074 seconds)] After epoch 5:
[2025-01-17 06:29:59,129][INFO] Loaded 100 points for repair.
[2025-01-17 06:29:59,129][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:29:59,129][INFO] Loaded 10000 points for training.
[2025-01-17 06:29:59,129][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:29:59,340][INFO] min loss 0.0, max loss 12108.12109375.
[2025-01-17 06:29:59,383][INFO] Test set accuracy 0.9827.
[2025-01-17 06:29:59,383][INFO] repair set accuracy 1.0.
[2025-01-17 06:29:59,383][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:29:59,383][INFO] 
[0m 3s (3.329 seconds)] Starting epoch 6:
[2025-01-17 06:29:59,724][INFO] [0m 3s (3.669 seconds)] After epoch 6:
[2025-01-17 06:29:59,724][INFO] Loaded 100 points for repair.
[2025-01-17 06:29:59,724][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:29:59,724][INFO] Loaded 10000 points for training.
[2025-01-17 06:29:59,724][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:29:59,935][INFO] min loss 0.0, max loss 12017.955078125.
[2025-01-17 06:29:59,978][INFO] Test set accuracy 0.9827.
[2025-01-17 06:29:59,978][INFO] repair set accuracy 1.0.
[2025-01-17 06:29:59,978][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:29:59,978][INFO] 
[0m 3s (3.923 seconds)] Starting epoch 7:
[2025-01-17 06:30:00,320][INFO] [0m 4s (4.265 seconds)] After epoch 7:
[2025-01-17 06:30:00,320][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:00,320][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:00,320][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:00,320][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:00,531][INFO] min loss 0.0, max loss 5897.4521484375.
[2025-01-17 06:30:00,573][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:00,573][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:00,573][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:00,573][INFO] 
[0m 4s (4.519 seconds)] Starting epoch 8:
[2025-01-17 06:30:00,913][INFO] [0m 4s (4.859 seconds)] After epoch 8:
[2025-01-17 06:30:00,913][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:00,913][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:00,913][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:00,914][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:01,124][INFO] min loss 0.0, max loss 1357.763671875.
[2025-01-17 06:30:01,166][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:01,167][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:01,167][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:01,167][INFO] 
[0m 5s (5.112 seconds)] Starting epoch 9:
[2025-01-17 06:30:01,507][INFO] [0m 5s (5.453 seconds)] After epoch 9:
[2025-01-17 06:30:01,507][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:01,507][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:01,508][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:01,508][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:01,718][INFO] min loss 0.0, max loss 4875.7998046875.
[2025-01-17 06:30:01,761][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:01,761][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:01,761][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:01,828][INFO] Accuracy at every epoch: [0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827]
[2025-01-17 06:30:01,829][INFO] After 9 epochs / 0m 5s (5.707 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2025-01-17 06:30:01,931][INFO] [0m 5s (5.876 seconds)] Start repair part 1: 100
[2025-01-17 06:30:01,931][INFO] [0m 5s (5.877 seconds)] After epoch 0:
[2025-01-17 06:30:01,931][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:01,931][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:01,931][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:01,931][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:02,141][INFO] min loss 10724.49609375, max loss 13571.46484375.
[2025-01-17 06:30:02,183][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:02,183][INFO] repair set accuracy 0.0.
[2025-01-17 06:30:02,183][INFO] attacked test set accuracy 0.001.
[2025-01-17 06:30:02,183][INFO] 
[0m 6s (6.129 seconds)] Starting epoch 1:
[2025-01-17 06:30:02,543][INFO] [0m 6s (6.488 seconds)] After epoch 1:
[2025-01-17 06:30:02,543][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:02,543][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:02,543][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:02,543][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:02,755][INFO] min loss 16304.2158203125, max loss 43272.20703125.
[2025-01-17 06:30:02,797][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:02,797][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:02,797][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:02,797][INFO] 
[0m 6s (6.743 seconds)] Starting epoch 2:
[2025-01-17 06:30:03,154][INFO] [0m 7s (7.099 seconds)] After epoch 2:
[2025-01-17 06:30:03,154][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:03,154][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:03,154][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:03,154][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:03,364][INFO] min loss 0.0, max loss 38308.0546875.
[2025-01-17 06:30:03,407][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:03,407][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:03,407][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:03,407][INFO] 
[0m 7s (7.352 seconds)] Starting epoch 3:
[2025-01-17 06:30:03,762][INFO] [0m 7s (7.708 seconds)] After epoch 3:
[2025-01-17 06:30:03,762][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:03,763][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:03,763][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:03,763][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:03,973][INFO] min loss 0.0, max loss 20638.171875.
[2025-01-17 06:30:04,016][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:04,016][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:04,016][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:04,016][INFO] 
[0m 7s (7.961 seconds)] Starting epoch 4:
[2025-01-17 06:30:04,371][INFO] [0m 8s (8.316 seconds)] After epoch 4:
[2025-01-17 06:30:04,371][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:04,371][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:04,371][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:04,371][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:04,581][INFO] min loss 0.0, max loss 3828.1298828125.
[2025-01-17 06:30:04,623][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:04,623][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:04,623][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:04,623][INFO] 
[0m 8s (8.569 seconds)] Starting epoch 5:
[2025-01-17 06:30:04,978][INFO] [0m 8s (8.923 seconds)] After epoch 5:
[2025-01-17 06:30:04,978][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:04,978][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:04,978][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:04,978][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:05,188][INFO] min loss 0.0, max loss 12130.1337890625.
[2025-01-17 06:30:05,231][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:05,231][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:05,231][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:05,231][INFO] 
[0m 9s (9.177 seconds)] Starting epoch 6:
[2025-01-17 06:30:05,586][INFO] [0m 9s (9.531 seconds)] After epoch 6:
[2025-01-17 06:30:05,586][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:05,586][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:05,586][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:05,586][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:05,797][INFO] min loss 0.0, max loss 12059.791015625.
[2025-01-17 06:30:05,839][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:05,839][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:05,839][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:05,839][INFO] 
[0m 9s (9.785 seconds)] Starting epoch 7:
[2025-01-17 06:30:06,195][INFO] [0m 10s (10.141 seconds)] After epoch 7:
[2025-01-17 06:30:06,195][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:06,196][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:06,196][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:06,196][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:06,405][INFO] min loss 0.0, max loss 5714.0.
[2025-01-17 06:30:06,447][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:06,448][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:06,448][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:06,448][INFO] 
[0m 10s (10.393 seconds)] Starting epoch 8:
[2025-01-17 06:30:06,803][INFO] [0m 10s (10.748 seconds)] After epoch 8:
[2025-01-17 06:30:06,803][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:06,803][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:06,803][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:06,803][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:07,014][INFO] min loss 0.0, max loss 2066.3525390625.
[2025-01-17 06:30:07,056][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:07,056][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:07,056][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:07,057][INFO] 
[0m 11s (11.002 seconds)] Starting epoch 9:
[2025-01-17 06:30:07,412][INFO] [0m 11s (11.357 seconds)] After epoch 9:
[2025-01-17 06:30:07,412][INFO] Loaded 100 points for repair.
[2025-01-17 06:30:07,412][INFO] Loaded 1000 points for attack test.
[2025-01-17 06:30:07,412][INFO] Loaded 10000 points for training.
[2025-01-17 06:30:07,412][INFO] Loaded 100 abstractions for training.
[2025-01-17 06:30:07,622][INFO] min loss 0.0, max loss 1461.13134765625.
[2025-01-17 06:30:07,665][INFO] Test set accuracy 0.9827.
[2025-01-17 06:30:07,665][INFO] repair set accuracy 1.0.
[2025-01-17 06:30:07,665][INFO] attacked test set accuracy 1.0.
[2025-01-17 06:30:07,744][INFO] Accuracy at every epoch: [0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827, 0.9827]
[2025-01-17 06:30:07,745][INFO] After 9 epochs / 0m 11s (11.611 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2025-01-17 06:30:07,745][INFO] final test
[2025-01-17 06:30:07,751][INFO] --Test set accuracy 0.9827
[2025-01-17 06:30:07,783][INFO] --Test repair set accuracy 1.0
[2025-01-17 06:30:07,816][INFO] --Test attack test set accuracy 1.0
[2025-01-17 06:30:07,816][INFO] training time 11.761612508445978s
[2025-01-17 06:30:07,825][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2025-01-17 06:30:07,825][INFO] tensor([ 9.0000, 11.6106,  0.0000,  0.9827])
[2025-01-17 06:30:07,826][INFO] Total Cost Time: 14.874181672930717s.



