[2024-01-02 12:24:05,804][INFO] 
===== FNN_small-0.3-500-big-2024-01-02-12-24-05 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 3e-05
  lr: 10
  batch_size: 50
  min_epochs: 15
  max_epochs: 100
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: FNN_small
  no_repair: False
  repair_number: 500
  repair_batchsize: 1
  patch_size: big
  repair_radius: 0.3
  divided_repair: 5
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x7f8cad88d820>
  reset_params: False
  train_datasize: 10000
  test_datasize: 5000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 500
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7f8de5b44790>
===== end of FNN_small-0.3-500-big-2024-01-02-12-24-05 configuration =====

[2024-01-02 12:24:05,804][INFO] ===== start repair ======
[2024-01-02 12:24:05,804][INFO] For pgd attack net
[2024-01-02 12:24:05,946][INFO] --Test repair set accuracy 0.0
[2024-01-02 12:24:05,947][INFO] --Test original set accuracy 0.996
[2024-01-02 12:24:05,947][INFO] --Test test set accuracy 0.9658
[2024-01-02 12:24:05,948][INFO] --Test attack test set accuracy 0.0
[2024-01-02 12:24:05,948][INFO] --Test train set accuracy 0.9929
[2024-01-02 12:24:26,141][INFO] --big patch network: --- PatchNet ---
Name: big patch network 9
--- End of PatchNet ---
[2024-01-02 12:24:26,160][INFO] [0m 0s (0.018 seconds)] Start repair part 0: 0
[2024-01-02 12:24:26,160][INFO] [0m 0s (0.018 seconds)] After epoch 0:
[2024-01-02 12:24:26,160][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:26,160][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:26,160][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:26,160][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:26,227][INFO] min loss 530762.75, max loss 1188496.625.
[2024-01-02 12:24:26,228][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:26,236][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:26,236][INFO] repair set accuracy 0.0.
[2024-01-02 12:24:26,236][INFO] attacked test set accuracy 0.0.
[2024-01-02 12:24:26,236][INFO] 
[0m 0s (0.094 seconds)] Starting epoch 1:
[2024-01-02 12:24:26,336][INFO] [0m 0s (0.194 seconds)] After epoch 1:
[2024-01-02 12:24:26,336][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:26,336][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:26,336][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:26,336][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:26,403][INFO] min loss 530227.9375, max loss 1187996.25.
[2024-01-02 12:24:26,404][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:26,413][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:26,413][INFO] repair set accuracy 0.11.
[2024-01-02 12:24:26,413][INFO] attacked test set accuracy 0.49.
[2024-01-02 12:24:26,413][INFO] 
[0m 0s (0.272 seconds)] Starting epoch 2:
[2024-01-02 12:24:26,543][INFO] [0m 0s (0.402 seconds)] After epoch 2:
[2024-01-02 12:24:26,544][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:26,544][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:26,544][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:26,544][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:26,609][INFO] min loss 530047.9375, max loss 1187816.25.
[2024-01-02 12:24:26,609][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:26,619][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:26,619][INFO] repair set accuracy 0.7.
[2024-01-02 12:24:26,619][INFO] attacked test set accuracy 0.81.
[2024-01-02 12:24:26,619][INFO] 
[0m 0s (0.477 seconds)] Starting epoch 3:
[2024-01-02 12:24:26,718][INFO] [0m 0s (0.576 seconds)] After epoch 3:
[2024-01-02 12:24:26,718][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:26,718][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:26,718][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:26,718][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:26,786][INFO] min loss 529867.9375, max loss 1187636.25.
[2024-01-02 12:24:26,787][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:26,795][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:26,795][INFO] repair set accuracy 0.88.
[2024-01-02 12:24:26,796][INFO] attacked test set accuracy 0.905.
[2024-01-02 12:24:26,796][INFO] 
[0m 0s (0.654 seconds)] Starting epoch 4:
[2024-01-02 12:24:26,895][INFO] [0m 0s (0.753 seconds)] After epoch 4:
[2024-01-02 12:24:26,895][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:26,895][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:26,895][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:26,895][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:26,962][INFO] min loss 529687.9375, max loss 1187456.25.
[2024-01-02 12:24:26,962][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:26,970][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:26,970][INFO] repair set accuracy 0.95.
[2024-01-02 12:24:26,970][INFO] attacked test set accuracy 0.946.
[2024-01-02 12:24:26,970][INFO] 
[0m 0s (0.829 seconds)] Starting epoch 5:
[2024-01-02 12:24:27,077][INFO] [0m 0s (0.935 seconds)] After epoch 5:
[2024-01-02 12:24:27,077][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:27,077][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:27,077][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:27,077][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:27,146][INFO] min loss 529507.9375, max loss 1187276.25.
[2024-01-02 12:24:27,146][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:27,154][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:27,154][INFO] repair set accuracy 0.96.
[2024-01-02 12:24:27,154][INFO] attacked test set accuracy 0.957.
[2024-01-02 12:24:27,154][INFO] 
[0m 1s (1.013 seconds)] Starting epoch 6:
[2024-01-02 12:24:27,258][INFO] [0m 1s (1.116 seconds)] After epoch 6:
[2024-01-02 12:24:27,258][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:27,258][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:27,258][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:27,258][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:27,327][INFO] min loss 529327.9375, max loss 1187096.25.
[2024-01-02 12:24:27,328][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:27,335][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:27,335][INFO] repair set accuracy 0.96.
[2024-01-02 12:24:27,335][INFO] attacked test set accuracy 0.962.
[2024-01-02 12:24:27,335][INFO] 
[0m 1s (1.194 seconds)] Starting epoch 7:
[2024-01-02 12:24:27,435][INFO] [0m 1s (1.293 seconds)] After epoch 7:
[2024-01-02 12:24:27,435][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:27,435][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:27,435][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:27,435][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:27,502][INFO] min loss 529147.9375, max loss 1186916.25.
[2024-01-02 12:24:27,503][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:27,511][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:27,511][INFO] repair set accuracy 0.97.
[2024-01-02 12:24:27,511][INFO] attacked test set accuracy 0.975.
[2024-01-02 12:24:27,511][INFO] 
[0m 1s (1.369 seconds)] Starting epoch 8:
[2024-01-02 12:24:27,612][INFO] [0m 1s (1.471 seconds)] After epoch 8:
[2024-01-02 12:24:27,612][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:27,612][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:27,612][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:27,612][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:27,680][INFO] min loss 528967.9375, max loss 1186736.25.
[2024-01-02 12:24:27,680][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:27,689][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:27,689][INFO] repair set accuracy 0.98.
[2024-01-02 12:24:27,689][INFO] attacked test set accuracy 0.984.
[2024-01-02 12:24:27,689][INFO] 
[0m 1s (1.547 seconds)] Starting epoch 9:
[2024-01-02 12:24:27,786][INFO] [0m 1s (1.644 seconds)] After epoch 9:
[2024-01-02 12:24:27,786][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:27,786][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:27,786][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:27,786][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:27,856][INFO] min loss 528787.9375, max loss 1186556.25.
[2024-01-02 12:24:27,856][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:27,864][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:27,864][INFO] repair set accuracy 0.99.
[2024-01-02 12:24:27,864][INFO] attacked test set accuracy 0.99.
[2024-01-02 12:24:27,865][INFO] 
[0m 1s (1.723 seconds)] Starting epoch 10:
[2024-01-02 12:24:27,967][INFO] [0m 1s (1.826 seconds)] After epoch 10:
[2024-01-02 12:24:27,967][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:27,967][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:27,968][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:27,968][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:28,036][INFO] min loss 528607.9375, max loss 1186376.25.
[2024-01-02 12:24:28,036][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:28,044][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:28,045][INFO] repair set accuracy 0.99.
[2024-01-02 12:24:28,045][INFO] attacked test set accuracy 0.99.
[2024-01-02 12:24:28,058][INFO] Accuracy at every epoch: [0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658, 0.9658]
[2024-01-02 12:24:28,058][INFO] After 10 epochs / 0m 1s (1.903 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 0.9900 accuracy on repair set,with 0.9900 accuracy on attack test set.
[2024-01-02 12:24:28,076][INFO] [0m 1s (1.934 seconds)] Start repair part 1: 100
[2024-01-02 12:24:28,076][INFO] [0m 1s (1.934 seconds)] After epoch 0:
[2024-01-02 12:24:28,076][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:28,076][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:28,076][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:28,076][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:28,144][INFO] min loss 545192.625, max loss 1184592.25.
[2024-01-02 12:24:28,144][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:28,153][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:28,153][INFO] repair set accuracy 1.0.
[2024-01-02 12:24:28,153][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:24:28,177][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:24:28,178][INFO] After 0 epochs / 0m 2s (2.012 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:24:28,195][INFO] [0m 2s (2.053 seconds)] Start repair part 2: 200
[2024-01-02 12:24:28,195][INFO] [0m 2s (2.053 seconds)] After epoch 0:
[2024-01-02 12:24:28,195][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:28,195][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:28,195][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:28,195][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:28,263][INFO] min loss 534561.875, max loss 1188689.375.
[2024-01-02 12:24:28,263][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:28,271][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:28,272][INFO] repair set accuracy 1.0.
[2024-01-02 12:24:28,272][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:24:28,285][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:24:28,285][INFO] After 0 epochs / 0m 2s (2.130 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:24:28,303][INFO] [0m 2s (2.161 seconds)] Start repair part 3: 300
[2024-01-02 12:24:28,303][INFO] [0m 2s (2.161 seconds)] After epoch 0:
[2024-01-02 12:24:28,303][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:28,303][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:28,303][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:28,303][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:28,370][INFO] min loss 545333.9375, max loss 1184524.0.
[2024-01-02 12:24:28,370][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:28,378][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:28,378][INFO] repair set accuracy 0.98.
[2024-01-02 12:24:28,378][INFO] attacked test set accuracy 0.988.
[2024-01-02 12:24:28,378][INFO] 
[0m 2s (2.237 seconds)] Starting epoch 1:
[2024-01-02 12:24:28,477][INFO] [0m 2s (2.335 seconds)] After epoch 1:
[2024-01-02 12:24:28,477][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:28,477][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:28,477][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:28,477][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:28,544][INFO] min loss 545153.9375, max loss 1184344.0.
[2024-01-02 12:24:28,544][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:28,553][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:28,553][INFO] repair set accuracy 0.99.
[2024-01-02 12:24:28,553][INFO] attacked test set accuracy 0.999.
[2024-01-02 12:24:28,553][INFO] 
[0m 2s (2.412 seconds)] Starting epoch 2:
[2024-01-02 12:24:28,648][INFO] [0m 2s (2.506 seconds)] After epoch 2:
[2024-01-02 12:24:28,648][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:28,648][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:28,648][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:28,648][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:28,716][INFO] min loss 544973.9375, max loss 1184164.0.
[2024-01-02 12:24:28,716][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:28,725][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:28,725][INFO] repair set accuracy 1.0.
[2024-01-02 12:24:28,725][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:24:28,739][INFO] Accuracy at every epoch: [0.9658, 0.9658, 0.9658]
[2024-01-02 12:24:28,739][INFO] After 2 epochs / 0m 2s (2.583 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:24:28,757][INFO] [0m 2s (2.616 seconds)] Start repair part 4: 400
[2024-01-02 12:24:28,757][INFO] [0m 2s (2.616 seconds)] After epoch 0:
[2024-01-02 12:24:28,757][INFO] Loaded 100 points for repair.
[2024-01-02 12:24:28,757][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:24:28,757][INFO] Loaded 10000 points for training.
[2024-01-02 12:24:28,757][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:24:28,826][INFO] min loss 529437.125, max loss 1182773.875.
[2024-01-02 12:24:28,826][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:24:28,834][INFO] Test set accuracy 0.9658.
[2024-01-02 12:24:28,834][INFO] repair set accuracy 1.0.
[2024-01-02 12:24:28,834][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:24:28,848][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:24:28,848][INFO] After 0 epochs / 0m 2s (2.692 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:24:28,848][INFO] final test
[2024-01-02 12:24:28,849][INFO] --Test set accuracy 0.9658
[2024-01-02 12:24:28,853][INFO] --Test repair set accuracy 0.998
[2024-01-02 12:24:28,857][INFO] --Test attack test set accuracy 0.998
[2024-01-02 12:24:28,857][INFO] training time 2.715328011661768s
[2024-01-02 12:24:28,859][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2024-01-02 12:24:28,860][INFO] tensor([0.0000, 2.6924, 0.0000, 0.9658])
[2024-01-02 12:24:28,860][INFO] Total Cost Time: 23.055982194840908s.



