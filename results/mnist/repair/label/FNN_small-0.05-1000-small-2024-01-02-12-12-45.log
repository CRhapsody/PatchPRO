[2024-01-02 12:12:45,907][INFO] 
===== FNN_small-0.05-1000-small-2024-01-02-12-12-45 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 5e-06
  lr: 10
  batch_size: 50
  min_epochs: 15
  max_epochs: 100
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: FNN_small
  no_repair: False
  repair_number: 1000
  repair_batchsize: 1
  patch_size: small
  repair_radius: 0.05
  divided_repair: 10
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x7f8d8a5f0ee0>
  reset_params: False
  train_datasize: 10000
  test_datasize: 10000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 1000
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7f8d8a5c50d0>
===== end of FNN_small-0.05-1000-small-2024-01-02-12-12-45 configuration =====

[2024-01-02 12:12:45,908][INFO] ===== start repair ======
[2024-01-02 12:12:45,908][INFO] For pgd attack net
[2024-01-02 12:12:47,508][INFO] --Test repair set accuracy 0.0
[2024-01-02 12:12:47,509][INFO] --Test original set accuracy 0.991
[2024-01-02 12:12:47,510][INFO] --Test test set accuracy 0.9658
[2024-01-02 12:12:47,510][INFO] --Test attack test set accuracy 0.0
[2024-01-02 12:12:47,511][INFO] --Test train set accuracy 0.9929
[2024-01-02 12:14:17,663][INFO] --small patch network: --- PatchNet ---
Name: small patch network 9
--- End of PatchNet ---
[2024-01-02 12:14:17,692][INFO] [0m 0s (0.026 seconds)] Start repair part 0: 0
[2024-01-02 12:14:17,692][INFO] [0m 0s (0.027 seconds)] After epoch 0:
[2024-01-02 12:14:17,692][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:17,692][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:17,692][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:17,692][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:17,787][INFO] min loss 75187.84375, max loss 198619.6875.
[2024-01-02 12:14:17,788][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:17,797][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:17,797][INFO] repair set accuracy 0.0.
[2024-01-02 12:14:17,797][INFO] attacked test set accuracy 0.0.
[2024-01-02 12:14:17,797][INFO] 
[0m 0s (0.132 seconds)] Starting epoch 1:
[2024-01-02 12:14:17,927][INFO] [0m 0s (0.262 seconds)] After epoch 1:
[2024-01-02 12:14:17,927][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:17,927][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:17,927][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:17,928][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:18,022][INFO] min loss 74987.546875, max loss 198422.4375.
[2024-01-02 12:14:18,022][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:18,032][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:18,033][INFO] repair set accuracy 0.78.
[2024-01-02 12:14:18,033][INFO] attacked test set accuracy 0.837.
[2024-01-02 12:14:18,033][INFO] 
[0m 0s (0.368 seconds)] Starting epoch 2:
[2024-01-02 12:14:18,158][INFO] [0m 0s (0.493 seconds)] After epoch 2:
[2024-01-02 12:14:18,158][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:18,158][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:18,159][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:18,159][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:18,261][INFO] min loss 74807.546875, max loss 198242.4375.
[2024-01-02 12:14:18,262][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:18,272][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:18,272][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:18,272][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:18,285][INFO] Accuracy at every epoch: [0.9658, 0.9658, 0.9658]
[2024-01-02 12:14:18,285][INFO] After 2 epochs / 0m 0s (0.607 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:18,348][INFO] [0m 0s (0.683 seconds)] Start repair part 1: 100
[2024-01-02 12:14:18,348][INFO] [0m 0s (0.683 seconds)] After epoch 0:
[2024-01-02 12:14:18,348][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:18,348][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:18,349][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:18,349][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:18,446][INFO] min loss 75190.8359375, max loss 199259.71875.
[2024-01-02 12:14:18,446][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:18,456][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:18,456][INFO] repair set accuracy 0.99.
[2024-01-02 12:14:18,456][INFO] attacked test set accuracy 0.992.
[2024-01-02 12:14:18,457][INFO] 
[0m 0s (0.791 seconds)] Starting epoch 1:
[2024-01-02 12:14:18,587][INFO] [0m 0s (0.922 seconds)] After epoch 1:
[2024-01-02 12:14:18,588][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:18,588][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:18,588][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:18,588][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:18,686][INFO] min loss 75010.8359375, max loss 199079.71875.
[2024-01-02 12:14:18,687][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:18,697][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:18,697][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:18,697][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:18,710][INFO] Accuracy at every epoch: [0.9658, 0.9658]
[2024-01-02 12:14:18,710][INFO] After 1 epochs / 0m 1s (1.032 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:18,737][INFO] [0m 1s (1.072 seconds)] Start repair part 2: 200
[2024-01-02 12:14:18,737][INFO] [0m 1s (1.072 seconds)] After epoch 0:
[2024-01-02 12:14:18,737][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:18,737][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:18,737][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:18,738][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:18,838][INFO] min loss 76696.953125, max loss 200809.34375.
[2024-01-02 12:14:18,839][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:18,850][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:18,850][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:18,850][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:18,862][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:14:18,862][INFO] After 0 epochs / 0m 1s (1.185 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:18,892][INFO] [0m 1s (1.227 seconds)] Start repair part 3: 300
[2024-01-02 12:14:18,892][INFO] [0m 1s (1.227 seconds)] After epoch 0:
[2024-01-02 12:14:18,892][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:18,892][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:18,892][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:18,892][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:18,991][INFO] min loss 61750.90234375, max loss 196092.6875.
[2024-01-02 12:14:18,992][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:19,002][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:19,002][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:19,002][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:19,015][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:14:19,015][INFO] After 0 epochs / 0m 1s (1.337 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:19,042][INFO] [0m 1s (1.377 seconds)] Start repair part 4: 400
[2024-01-02 12:14:19,042][INFO] [0m 1s (1.377 seconds)] After epoch 0:
[2024-01-02 12:14:19,042][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:19,042][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:19,042][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:19,042][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:19,140][INFO] min loss 80378.90625, max loss 200903.96875.
[2024-01-02 12:14:19,140][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:19,150][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:19,151][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:19,151][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:19,163][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:14:19,163][INFO] After 0 epochs / 0m 1s (1.486 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:19,190][INFO] [0m 1s (1.525 seconds)] Start repair part 5: 500
[2024-01-02 12:14:19,191][INFO] [0m 1s (1.525 seconds)] After epoch 0:
[2024-01-02 12:14:19,191][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:19,191][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:19,191][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:19,191][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:19,287][INFO] min loss 64559.6484375, max loss 200543.4375.
[2024-01-02 12:14:19,288][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:19,298][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:19,298][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:19,299][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:19,312][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:14:19,312][INFO] After 0 epochs / 0m 1s (1.634 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:19,340][INFO] [0m 1s (1.674 seconds)] Start repair part 6: 600
[2024-01-02 12:14:19,340][INFO] [0m 1s (1.675 seconds)] After epoch 0:
[2024-01-02 12:14:19,340][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:19,340][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:19,340][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:19,340][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:19,439][INFO] min loss 78090.65625, max loss 201522.984375.
[2024-01-02 12:14:19,440][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:19,450][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:19,451][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:19,451][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:19,463][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:14:19,463][INFO] After 0 epochs / 0m 1s (1.786 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:19,490][INFO] [0m 1s (1.825 seconds)] Start repair part 7: 700
[2024-01-02 12:14:19,491][INFO] [0m 1s (1.825 seconds)] After epoch 0:
[2024-01-02 12:14:19,491][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:19,491][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:19,491][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:19,491][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:19,590][INFO] min loss 69539.28125, max loss 197690.28125.
[2024-01-02 12:14:19,591][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:19,603][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:19,603][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:19,603][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:19,616][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:14:19,616][INFO] After 0 epochs / 0m 1s (1.938 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:19,643][INFO] [0m 1s (1.978 seconds)] Start repair part 8: 800
[2024-01-02 12:14:19,643][INFO] [0m 1s (1.978 seconds)] After epoch 0:
[2024-01-02 12:14:19,644][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:19,644][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:19,644][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:19,644][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:19,742][INFO] min loss 68636.71875, max loss 203399.8125.
[2024-01-02 12:14:19,743][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:19,755][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:19,755][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:19,755][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:19,767][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:14:19,767][INFO] After 0 epochs / 0m 2s (2.090 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:19,793][INFO] [0m 2s (2.128 seconds)] Start repair part 9: 900
[2024-01-02 12:14:19,794][INFO] [0m 2s (2.129 seconds)] After epoch 0:
[2024-01-02 12:14:19,794][INFO] Loaded 100 points for repair.
[2024-01-02 12:14:19,794][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:14:19,794][INFO] Loaded 10000 points for training.
[2024-01-02 12:14:19,794][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:14:19,893][INFO] min loss 74350.3984375, max loss 205428.9375.
[2024-01-02 12:14:19,894][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:14:19,904][INFO] Test set accuracy 0.9658.
[2024-01-02 12:14:19,904][INFO] repair set accuracy 1.0.
[2024-01-02 12:14:19,905][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:14:19,918][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:14:19,918][INFO] After 0 epochs / 0m 2s (2.239 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:14:19,918][INFO] final test
[2024-01-02 12:14:19,919][INFO] --Test set accuracy 0.9658
[2024-01-02 12:14:19,925][INFO] --Test repair set accuracy 1.0
[2024-01-02 12:14:19,930][INFO] --Test attack test set accuracy 1.0
[2024-01-02 12:14:19,930][INFO] training time 2.265241000801325s
[2024-01-02 12:14:19,934][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2024-01-02 12:14:19,936][INFO] tensor([0.0000, 2.2395, 0.0000, 0.9658])
[2024-01-02 12:14:19,937][INFO] Total Cost Time: 94.03040845692158s.



