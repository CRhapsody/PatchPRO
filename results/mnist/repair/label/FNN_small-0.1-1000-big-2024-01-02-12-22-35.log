[2024-01-02 12:22:35,675][INFO] 
===== FNN_small-0.1-1000-big-2024-01-02-12-22-35 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 1e-05
  lr: 10
  batch_size: 50
  min_epochs: 15
  max_epochs: 100
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: FNN_small
  no_repair: False
  repair_number: 1000
  repair_batchsize: 1
  patch_size: big
  repair_radius: 0.1
  divided_repair: 10
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x7f8cad87d040>
  reset_params: False
  train_datasize: 10000
  test_datasize: 10000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 1000
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7f8cad87d310>
===== end of FNN_small-0.1-1000-big-2024-01-02-12-22-35 configuration =====

[2024-01-02 12:22:35,676][INFO] ===== start repair ======
[2024-01-02 12:22:35,676][INFO] For pgd attack net
[2024-01-02 12:22:35,813][INFO] --Test repair set accuracy 0.0
[2024-01-02 12:22:35,814][INFO] --Test original set accuracy 0.993
[2024-01-02 12:22:35,814][INFO] --Test test set accuracy 0.9658
[2024-01-02 12:22:35,815][INFO] --Test attack test set accuracy 0.0
[2024-01-02 12:22:35,815][INFO] --Test train set accuracy 0.9929
[2024-01-02 12:23:53,617][INFO] --big patch network: --- PatchNet ---
Name: big patch network 9
--- End of PatchNet ---
[2024-01-02 12:23:53,634][INFO] [0m 0s (0.017 seconds)] Start repair part 0: 0
[2024-01-02 12:23:53,635][INFO] [0m 0s (0.017 seconds)] After epoch 0:
[2024-01-02 12:23:53,635][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:53,635][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:53,635][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:53,635][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:53,703][INFO] min loss 162547.34375, max loss 396167.34375.
[2024-01-02 12:23:53,704][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:53,712][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:53,712][INFO] repair set accuracy 0.0.
[2024-01-02 12:23:53,712][INFO] attacked test set accuracy 0.001.
[2024-01-02 12:23:53,712][INFO] 
[0m 0s (0.095 seconds)] Starting epoch 1:
[2024-01-02 12:23:53,820][INFO] [0m 0s (0.203 seconds)] After epoch 1:
[2024-01-02 12:23:53,820][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:53,820][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:53,820][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:53,821][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:53,891][INFO] min loss 162273.28125, max loss 395882.5625.
[2024-01-02 12:23:53,891][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:53,899][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:53,899][INFO] repair set accuracy 0.32.
[2024-01-02 12:23:53,899][INFO] attacked test set accuracy 0.611.
[2024-01-02 12:23:53,899][INFO] 
[0m 0s (0.282 seconds)] Starting epoch 2:
[2024-01-02 12:23:54,007][INFO] [0m 0s (0.389 seconds)] After epoch 2:
[2024-01-02 12:23:54,007][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:54,007][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:54,007][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:54,007][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:54,076][INFO] min loss 162093.28125, max loss 395702.5625.
[2024-01-02 12:23:54,076][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:54,086][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:54,086][INFO] repair set accuracy 0.87.
[2024-01-02 12:23:54,086][INFO] attacked test set accuracy 0.937.
[2024-01-02 12:23:54,086][INFO] 
[0m 0s (0.469 seconds)] Starting epoch 3:
[2024-01-02 12:23:54,188][INFO] [0m 0s (0.570 seconds)] After epoch 3:
[2024-01-02 12:23:54,188][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:54,188][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:54,188][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:54,188][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:54,256][INFO] min loss 161913.28125, max loss 395522.5625.
[2024-01-02 12:23:54,257][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:54,265][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:54,265][INFO] repair set accuracy 0.99.
[2024-01-02 12:23:54,265][INFO] attacked test set accuracy 0.993.
[2024-01-02 12:23:54,265][INFO] 
[0m 0s (0.648 seconds)] Starting epoch 4:
[2024-01-02 12:23:54,380][INFO] [0m 0s (0.763 seconds)] After epoch 4:
[2024-01-02 12:23:54,381][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:54,381][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:54,381][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:54,381][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:54,451][INFO] min loss 161733.28125, max loss 395342.5625.
[2024-01-02 12:23:54,451][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:54,461][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:54,461][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:54,461][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:54,475][INFO] Accuracy at every epoch: [0.9658, 0.9658, 0.9658, 0.9658, 0.9658]
[2024-01-02 12:23:54,476][INFO] After 4 epochs / 0m 0s (0.844 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:54,495][INFO] [0m 0s (0.878 seconds)] Start repair part 1: 100
[2024-01-02 12:23:54,495][INFO] [0m 0s (0.878 seconds)] After epoch 0:
[2024-01-02 12:23:54,495][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:54,495][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:54,495][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:54,495][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:54,565][INFO] min loss 175288.21875, max loss 394416.6875.
[2024-01-02 12:23:54,566][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:54,574][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:54,574][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:54,574][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:54,601][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:23:54,601][INFO] After 0 epochs / 0m 0s (0.957 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:54,618][INFO] [0m 1s (1.001 seconds)] Start repair part 2: 200
[2024-01-02 12:23:54,618][INFO] [0m 1s (1.001 seconds)] After epoch 0:
[2024-01-02 12:23:54,618][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:54,618][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:54,618][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:54,618][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:54,688][INFO] min loss 167330.5, max loss 397836.90625.
[2024-01-02 12:23:54,688][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:54,697][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:54,697][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:54,697][INFO] attacked test set accuracy 0.996.
[2024-01-02 12:23:54,697][INFO] 
[0m 1s (1.080 seconds)] Starting epoch 1:
[2024-01-02 12:23:54,806][INFO] [0m 1s (1.189 seconds)] After epoch 1:
[2024-01-02 12:23:54,806][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:54,806][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:54,806][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:54,806][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:54,884][INFO] min loss 167150.5, max loss 397656.90625.
[2024-01-02 12:23:54,884][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:54,894][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:54,894][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:54,894][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:54,909][INFO] Accuracy at every epoch: [0.9658, 0.9658]
[2024-01-02 12:23:54,909][INFO] After 1 epochs / 0m 1s (1.277 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:54,928][INFO] [0m 1s (1.311 seconds)] Start repair part 3: 300
[2024-01-02 12:23:54,929][INFO] [0m 1s (1.311 seconds)] After epoch 0:
[2024-01-02 12:23:54,929][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:54,929][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:54,929][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:54,929][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:54,998][INFO] min loss 166863.15625, max loss 393257.96875.
[2024-01-02 12:23:54,999][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:55,008][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:55,008][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:55,008][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:55,024][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:23:55,024][INFO] After 0 epochs / 0m 1s (1.391 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:55,041][INFO] [0m 1s (1.423 seconds)] Start repair part 4: 400
[2024-01-02 12:23:55,041][INFO] [0m 1s (1.423 seconds)] After epoch 0:
[2024-01-02 12:23:55,041][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:55,041][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:55,041][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:55,041][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:55,107][INFO] min loss 162735.3125, max loss 392322.0625.
[2024-01-02 12:23:55,107][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:55,115][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:55,115][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:55,115][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:55,130][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:23:55,130][INFO] After 0 epochs / 0m 1s (1.498 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:55,146][INFO] [0m 1s (1.529 seconds)] Start repair part 5: 500
[2024-01-02 12:23:55,146][INFO] [0m 1s (1.529 seconds)] After epoch 0:
[2024-01-02 12:23:55,146][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:55,146][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:55,146][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:55,146][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:55,214][INFO] min loss 165390.03125, max loss 396540.5.
[2024-01-02 12:23:55,215][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:55,223][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:55,223][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:55,223][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:55,237][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:23:55,238][INFO] After 0 epochs / 0m 1s (1.606 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:55,255][INFO] [0m 1s (1.638 seconds)] Start repair part 6: 600
[2024-01-02 12:23:55,255][INFO] [0m 1s (1.638 seconds)] After epoch 0:
[2024-01-02 12:23:55,255][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:55,256][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:55,256][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:55,256][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:55,321][INFO] min loss 149972.3125, max loss 397076.0.
[2024-01-02 12:23:55,322][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:55,332][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:55,332][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:55,332][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:55,348][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:23:55,348][INFO] After 0 epochs / 0m 1s (1.715 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:55,365][INFO] [0m 1s (1.748 seconds)] Start repair part 7: 700
[2024-01-02 12:23:55,365][INFO] [0m 1s (1.748 seconds)] After epoch 0:
[2024-01-02 12:23:55,365][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:55,365][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:55,365][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:55,365][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:55,431][INFO] min loss 166944.09375, max loss 393978.21875.
[2024-01-02 12:23:55,431][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:55,439][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:55,439][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:55,439][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:55,454][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:23:55,454][INFO] After 0 epochs / 0m 1s (1.822 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:55,471][INFO] [0m 1s (1.854 seconds)] Start repair part 8: 800
[2024-01-02 12:23:55,471][INFO] [0m 1s (1.854 seconds)] After epoch 0:
[2024-01-02 12:23:55,471][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:55,471][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:55,471][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:55,471][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:55,538][INFO] min loss 165417.34375, max loss 397934.75.
[2024-01-02 12:23:55,538][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:55,546][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:55,546][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:55,546][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:55,559][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:23:55,559][INFO] After 0 epochs / 0m 1s (1.929 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:55,577][INFO] [0m 1s (1.960 seconds)] Start repair part 9: 900
[2024-01-02 12:23:55,577][INFO] [0m 1s (1.960 seconds)] After epoch 0:
[2024-01-02 12:23:55,577][INFO] Loaded 100 points for repair.
[2024-01-02 12:23:55,577][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:23:55,578][INFO] Loaded 10000 points for training.
[2024-01-02 12:23:55,578][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:23:55,645][INFO] min loss 164781.171875, max loss 394999.96875.
[2024-01-02 12:23:55,645][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:23:55,654][INFO] Test set accuracy 0.9658.
[2024-01-02 12:23:55,654][INFO] repair set accuracy 1.0.
[2024-01-02 12:23:55,654][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:23:55,669][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:23:55,669][INFO] After 0 epochs / 0m 2s (2.037 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:23:55,669][INFO] final test
[2024-01-02 12:23:55,670][INFO] --Test set accuracy 0.9658
[2024-01-02 12:23:55,673][INFO] --Test repair set accuracy 1.0
[2024-01-02 12:23:55,677][INFO] --Test attack test set accuracy 1.0
[2024-01-02 12:23:55,677][INFO] training time 2.060179490596056s
[2024-01-02 12:23:55,684][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2024-01-02 12:23:55,685][INFO] tensor([0.0000, 2.0369, 0.0000, 0.9658])
[2024-01-02 12:23:55,685][INFO] Total Cost Time: 80.00983240827918s.



