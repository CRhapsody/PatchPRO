[2024-01-02 12:15:59,862][INFO] 
===== FNN_small-0.05-500-big-2024-01-02-12-15-59 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 5e-06
  lr: 10
  batch_size: 50
  min_epochs: 15
  max_epochs: 100
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: FNN_small
  no_repair: False
  repair_number: 500
  repair_batchsize: 1
  patch_size: big
  repair_radius: 0.05
  divided_repair: 5
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x7fa41cdbcc10>
  reset_params: False
  train_datasize: 10000
  test_datasize: 5000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 500
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7fa2d00aaf70>
===== end of FNN_small-0.05-500-big-2024-01-02-12-15-59 configuration =====

[2024-01-02 12:15:59,862][INFO] ===== start repair ======
[2024-01-02 12:15:59,862][INFO] For pgd attack net
[2024-01-02 12:16:00,018][INFO] --Test repair set accuracy 0.0
[2024-01-02 12:16:00,019][INFO] --Test original set accuracy 0.994
[2024-01-02 12:16:00,020][INFO] --Test test set accuracy 0.9658
[2024-01-02 12:16:00,020][INFO] --Test attack test set accuracy 0.0
[2024-01-02 12:16:00,021][INFO] --Test train set accuracy 0.9929
[2024-01-02 12:16:20,360][INFO] --big patch network: --- PatchNet ---
Name: big patch network 9
--- End of PatchNet ---
[2024-01-02 12:16:20,388][INFO] [0m 0s (0.025 seconds)] Start repair part 0: 0
[2024-01-02 12:16:20,388][INFO] [0m 0s (0.025 seconds)] After epoch 0:
[2024-01-02 12:16:20,388][INFO] Loaded 100 points for repair.
[2024-01-02 12:16:20,388][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:16:20,388][INFO] Loaded 10000 points for training.
[2024-01-02 12:16:20,388][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:16:20,482][INFO] min loss 75213.3203125, max loss 198652.03125.
[2024-01-02 12:16:20,482][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:16:20,492][INFO] Test set accuracy 0.9658.
[2024-01-02 12:16:20,492][INFO] repair set accuracy 0.0.
[2024-01-02 12:16:20,492][INFO] attacked test set accuracy 0.0.
[2024-01-02 12:16:20,492][INFO] 
[0m 0s (0.130 seconds)] Starting epoch 1:
[2024-01-02 12:16:20,619][INFO] [0m 0s (0.256 seconds)] After epoch 1:
[2024-01-02 12:16:20,619][INFO] Loaded 100 points for repair.
[2024-01-02 12:16:20,619][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:16:20,619][INFO] Loaded 10000 points for training.
[2024-01-02 12:16:20,619][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:16:20,713][INFO] min loss 74989.90625, max loss 198421.09375.
[2024-01-02 12:16:20,713][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:16:20,723][INFO] Test set accuracy 0.9658.
[2024-01-02 12:16:20,723][INFO] repair set accuracy 0.78.
[2024-01-02 12:16:20,723][INFO] attacked test set accuracy 0.837.
[2024-01-02 12:16:20,723][INFO] 
[0m 0s (0.360 seconds)] Starting epoch 2:
[2024-01-02 12:16:20,850][INFO] [0m 0s (0.487 seconds)] After epoch 2:
[2024-01-02 12:16:20,850][INFO] Loaded 100 points for repair.
[2024-01-02 12:16:20,850][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:16:20,850][INFO] Loaded 10000 points for training.
[2024-01-02 12:16:20,850][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:16:20,948][INFO] min loss 74809.90625, max loss 198241.09375.
[2024-01-02 12:16:20,948][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:16:20,959][INFO] Test set accuracy 0.9658.
[2024-01-02 12:16:20,959][INFO] repair set accuracy 1.0.
[2024-01-02 12:16:20,959][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:16:20,977][INFO] Accuracy at every epoch: [0.9658, 0.9658, 0.9658]
[2024-01-02 12:16:20,977][INFO] After 2 epochs / 0m 0s (0.597 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:16:21,003][INFO] [0m 0s (0.641 seconds)] Start repair part 1: 100
[2024-01-02 12:16:21,004][INFO] [0m 0s (0.641 seconds)] After epoch 0:
[2024-01-02 12:16:21,004][INFO] Loaded 100 points for repair.
[2024-01-02 12:16:21,004][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:16:21,004][INFO] Loaded 10000 points for training.
[2024-01-02 12:16:21,004][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:16:21,102][INFO] min loss 75191.6875, max loss 199258.390625.
[2024-01-02 12:16:21,103][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:16:21,114][INFO] Test set accuracy 0.9658.
[2024-01-02 12:16:21,114][INFO] repair set accuracy 0.99.
[2024-01-02 12:16:21,114][INFO] attacked test set accuracy 0.992.
[2024-01-02 12:16:21,114][INFO] 
[0m 0s (0.752 seconds)] Starting epoch 1:
[2024-01-02 12:16:21,241][INFO] [0m 0s (0.879 seconds)] After epoch 1:
[2024-01-02 12:16:21,242][INFO] Loaded 100 points for repair.
[2024-01-02 12:16:21,242][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:16:21,242][INFO] Loaded 10000 points for training.
[2024-01-02 12:16:21,242][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:16:21,337][INFO] min loss 75011.6875, max loss 199078.390625.
[2024-01-02 12:16:21,338][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:16:21,349][INFO] Test set accuracy 0.9658.
[2024-01-02 12:16:21,349][INFO] repair set accuracy 1.0.
[2024-01-02 12:16:21,349][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:16:21,369][INFO] Accuracy at every epoch: [0.9658, 0.9658]
[2024-01-02 12:16:21,369][INFO] After 1 epochs / 0m 0s (0.987 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:16:21,396][INFO] [0m 1s (1.034 seconds)] Start repair part 2: 200
[2024-01-02 12:16:21,397][INFO] [0m 1s (1.034 seconds)] After epoch 0:
[2024-01-02 12:16:21,397][INFO] Loaded 100 points for repair.
[2024-01-02 12:16:21,397][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:16:21,397][INFO] Loaded 10000 points for training.
[2024-01-02 12:16:21,397][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:16:21,492][INFO] min loss 76698.734375, max loss 200808.03125.
[2024-01-02 12:16:21,492][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:16:21,502][INFO] Test set accuracy 0.9658.
[2024-01-02 12:16:21,502][INFO] repair set accuracy 1.0.
[2024-01-02 12:16:21,502][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:16:21,522][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:16:21,522][INFO] After 0 epochs / 0m 1s (1.139 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:16:21,547][INFO] [0m 1s (1.184 seconds)] Start repair part 3: 300
[2024-01-02 12:16:21,547][INFO] [0m 1s (1.184 seconds)] After epoch 0:
[2024-01-02 12:16:21,547][INFO] Loaded 100 points for repair.
[2024-01-02 12:16:21,547][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:16:21,547][INFO] Loaded 10000 points for training.
[2024-01-02 12:16:21,547][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:16:21,643][INFO] min loss 61753.453125, max loss 196091.359375.
[2024-01-02 12:16:21,644][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:16:21,654][INFO] Test set accuracy 0.9658.
[2024-01-02 12:16:21,654][INFO] repair set accuracy 1.0.
[2024-01-02 12:16:21,654][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:16:21,674][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:16:21,674][INFO] After 0 epochs / 0m 1s (1.292 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:16:21,699][INFO] [0m 1s (1.337 seconds)] Start repair part 4: 400
[2024-01-02 12:16:21,699][INFO] [0m 1s (1.337 seconds)] After epoch 0:
[2024-01-02 12:16:21,700][INFO] Loaded 100 points for repair.
[2024-01-02 12:16:21,700][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:16:21,700][INFO] Loaded 10000 points for training.
[2024-01-02 12:16:21,700][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:16:21,794][INFO] min loss 80380.640625, max loss 200902.65625.
[2024-01-02 12:16:21,795][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:16:21,804][INFO] Test set accuracy 0.9658.
[2024-01-02 12:16:21,804][INFO] repair set accuracy 1.0.
[2024-01-02 12:16:21,804][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:16:21,824][INFO] Accuracy at every epoch: [0.9658]
[2024-01-02 12:16:21,824][INFO] After 0 epochs / 0m 1s (1.442 seconds), eventually the trained network got certified? False, with 0.9658 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:16:21,824][INFO] final test
[2024-01-02 12:16:21,825][INFO] --Test set accuracy 0.9658
[2024-01-02 12:16:21,830][INFO] --Test repair set accuracy 1.0
[2024-01-02 12:16:21,835][INFO] --Test attack test set accuracy 1.0
[2024-01-02 12:16:21,835][INFO] training time 1.472634144127369s
[2024-01-02 12:16:21,838][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2024-01-02 12:16:21,838][INFO] tensor([0.0000, 1.4418, 0.0000, 0.9658])
[2024-01-02 12:16:21,839][INFO] Total Cost Time: 21.977077960968018s.



