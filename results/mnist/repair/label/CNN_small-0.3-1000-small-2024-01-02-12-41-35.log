[2024-01-02 12:41:35,180][INFO] 
===== CNN_small-0.3-1000-small-2024-01-02-12-41-35 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 3e-05
  lr: 10
  batch_size: 50
  min_epochs: 15
  max_epochs: 100
  use_scheduler: True
  no_pts: False
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: CNN_small
  no_repair: False
  repair_number: 1000
  repair_batchsize: 1
  patch_size: small
  repair_radius: 0.3
  divided_repair: 10
  accuracy_loss: <function MnistArgParser.setup_rest.<locals>.ce_loss at 0x7f8cac0bc4c0>
  reset_params: False
  train_datasize: 10000
  test_datasize: 10000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 1000
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7f8de5b44790>
===== end of CNN_small-0.3-1000-small-2024-01-02-12-41-35 configuration =====

[2024-01-02 12:41:35,180][INFO] ===== start repair ======
[2024-01-02 12:41:35,180][INFO] For pgd attack net
[2024-01-02 12:41:35,319][INFO] --Test repair set accuracy 0.0
[2024-01-02 12:41:35,319][INFO] --Test original set accuracy 0.994
[2024-01-02 12:41:35,321][INFO] --Test test set accuracy 0.9827
[2024-01-02 12:41:35,323][INFO] --Test attack test set accuracy 0.0
[2024-01-02 12:41:35,325][INFO] --Test train set accuracy 0.9927
[2024-01-02 12:42:54,556][INFO] --small patch network: --- PatchNet ---
Name: small patch network 9
--- End of PatchNet ---
[2024-01-02 12:42:54,694][INFO] [0m 0s (0.137 seconds)] Start repair part 0: 0
[2024-01-02 12:42:54,694][INFO] [0m 0s (0.138 seconds)] After epoch 0:
[2024-01-02 12:42:54,694][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:54,694][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:54,694][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:54,695][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:54,875][INFO] min loss 10932.1044921875, max loss 13674.171875.
[2024-01-02 12:42:54,876][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:54,885][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:54,885][INFO] repair set accuracy 0.0.
[2024-01-02 12:42:54,885][INFO] attacked test set accuracy 0.001.
[2024-01-02 12:42:54,885][INFO] 
[0m 0s (0.328 seconds)] Starting epoch 1:
[2024-01-02 12:42:54,989][INFO] [0m 0s (0.432 seconds)] After epoch 1:
[2024-01-02 12:42:54,989][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:54,989][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:54,989][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:54,989][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:55,175][INFO] min loss 10689.4345703125, max loss 13415.5654296875.
[2024-01-02 12:42:55,175][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:55,183][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:55,183][INFO] repair set accuracy 0.39.
[2024-01-02 12:42:55,184][INFO] attacked test set accuracy 0.478.
[2024-01-02 12:42:55,184][INFO] 
[0m 0s (0.627 seconds)] Starting epoch 2:
[2024-01-02 12:42:55,287][INFO] [0m 0s (0.730 seconds)] After epoch 2:
[2024-01-02 12:42:55,287][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:55,287][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:55,287][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:55,287][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:55,468][INFO] min loss 10509.4345703125, max loss 13235.5654296875.
[2024-01-02 12:42:55,469][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:55,478][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:55,478][INFO] repair set accuracy 0.82.
[2024-01-02 12:42:55,478][INFO] attacked test set accuracy 0.844.
[2024-01-02 12:42:55,478][INFO] 
[0m 0s (0.921 seconds)] Starting epoch 3:
[2024-01-02 12:42:55,605][INFO] [0m 1s (1.049 seconds)] After epoch 3:
[2024-01-02 12:42:55,606][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:55,606][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:55,606][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:55,606][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:55,792][INFO] min loss 10329.4345703125, max loss 13055.5654296875.
[2024-01-02 12:42:55,793][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:55,804][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:55,804][INFO] repair set accuracy 0.99.
[2024-01-02 12:42:55,804][INFO] attacked test set accuracy 0.99.
[2024-01-02 12:42:55,804][INFO] 
[0m 1s (1.247 seconds)] Starting epoch 4:
[2024-01-02 12:42:55,919][INFO] [0m 1s (1.362 seconds)] After epoch 4:
[2024-01-02 12:42:55,919][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:55,919][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:55,919][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:55,919][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:56,107][INFO] min loss 10149.4345703125, max loss 12875.5654296875.
[2024-01-02 12:42:56,107][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:56,117][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:56,117][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:56,117][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:56,125][INFO] Accuracy at every epoch: [0.9827, 0.9827, 0.9827, 0.9827, 0.9827]
[2024-01-02 12:42:56,125][INFO] After 4 epochs / 0m 1s (1.560 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:56,262][INFO] [0m 1s (1.706 seconds)] Start repair part 1: 100
[2024-01-02 12:42:56,262][INFO] [0m 1s (1.706 seconds)] After epoch 0:
[2024-01-02 12:42:56,263][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:56,263][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:56,263][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:56,263][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:56,452][INFO] min loss 10005.455078125, max loss 12846.76953125.
[2024-01-02 12:42:56,453][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:56,463][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:56,463][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:56,463][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:56,471][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:56,472][INFO] After 0 epochs / 0m 1s (1.906 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:56,608][INFO] [0m 2s (2.051 seconds)] Start repair part 2: 200
[2024-01-02 12:42:56,608][INFO] [0m 2s (2.051 seconds)] After epoch 0:
[2024-01-02 12:42:56,608][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:56,608][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:56,608][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:56,608][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:56,796][INFO] min loss 10127.69140625, max loss 13006.39453125.
[2024-01-02 12:42:56,797][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:56,806][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:56,806][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:56,806][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:56,815][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:56,815][INFO] After 0 epochs / 0m 2s (2.249 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:56,953][INFO] [0m 2s (2.397 seconds)] Start repair part 3: 300
[2024-01-02 12:42:56,953][INFO] [0m 2s (2.397 seconds)] After epoch 0:
[2024-01-02 12:42:56,954][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:56,954][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:56,954][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:56,954][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:57,146][INFO] min loss 9989.62890625, max loss 12798.33984375.
[2024-01-02 12:42:57,146][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:57,157][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:57,157][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:57,157][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:57,164][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:57,164][INFO] After 0 epochs / 0m 2s (2.600 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:57,304][INFO] [0m 2s (2.748 seconds)] Start repair part 4: 400
[2024-01-02 12:42:57,305][INFO] [0m 2s (2.748 seconds)] After epoch 0:
[2024-01-02 12:42:57,305][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:57,305][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:57,305][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:57,305][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:57,493][INFO] min loss 10052.8974609375, max loss 13135.126953125.
[2024-01-02 12:42:57,494][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:57,502][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:57,502][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:57,502][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:57,511][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:57,511][INFO] After 0 epochs / 0m 2s (2.946 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:57,649][INFO] [0m 3s (3.092 seconds)] Start repair part 5: 500
[2024-01-02 12:42:57,649][INFO] [0m 3s (3.092 seconds)] After epoch 0:
[2024-01-02 12:42:57,649][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:57,649][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:57,649][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:57,649][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:57,834][INFO] min loss 10043.298828125, max loss 12876.724609375.
[2024-01-02 12:42:57,834][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 1], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:57,845][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:57,845][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:57,845][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:57,855][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:57,855][INFO] After 0 epochs / 0m 3s (3.289 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:57,995][INFO] [0m 3s (3.438 seconds)] Start repair part 6: 600
[2024-01-02 12:42:57,995][INFO] [0m 3s (3.438 seconds)] After epoch 0:
[2024-01-02 12:42:57,995][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:57,995][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:57,995][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:57,995][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:58,182][INFO] min loss 10096.185546875, max loss 12950.998046875.
[2024-01-02 12:42:58,183][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:58,193][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:58,193][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:58,193][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:58,202][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:58,202][INFO] After 0 epochs / 0m 3s (3.636 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:58,343][INFO] [0m 3s (3.787 seconds)] Start repair part 7: 700
[2024-01-02 12:42:58,343][INFO] [0m 3s (3.787 seconds)] After epoch 0:
[2024-01-02 12:42:58,343][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:58,344][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:58,344][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:58,344][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:58,533][INFO] min loss 9652.0, max loss 12905.27734375.
[2024-01-02 12:42:58,533][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:58,545][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:58,545][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:58,545][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:58,553][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:58,553][INFO] After 0 epochs / 0m 3s (3.988 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:58,693][INFO] [0m 4s (4.137 seconds)] Start repair part 8: 800
[2024-01-02 12:42:58,694][INFO] [0m 4s (4.137 seconds)] After epoch 0:
[2024-01-02 12:42:58,694][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:58,694][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:58,694][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:58,694][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:58,886][INFO] min loss 9826.626953125, max loss 13005.82421875.
[2024-01-02 12:42:58,886][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:58,896][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:58,896][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:58,896][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:58,903][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:58,903][INFO] After 0 epochs / 0m 4s (4.339 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:59,041][INFO] [0m 4s (4.484 seconds)] Start repair part 9: 900
[2024-01-02 12:42:59,041][INFO] [0m 4s (4.485 seconds)] After epoch 0:
[2024-01-02 12:42:59,041][INFO] Loaded 100 points for repair.
[2024-01-02 12:42:59,041][INFO] Loaded 1000 points for attack test.
[2024-01-02 12:42:59,042][INFO] Loaded 10000 points for training.
[2024-01-02 12:42:59,042][INFO] Loaded 100 abstractions for training.
[2024-01-02 12:42:59,232][INFO] min loss 10177.3857421875, max loss 12722.306640625.
[2024-01-02 12:42:59,232][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 1, 0, 0, 0], device='cuda:3', dtype=torch.uint8).
[2024-01-02 12:42:59,241][INFO] Test set accuracy 0.9827.
[2024-01-02 12:42:59,241][INFO] repair set accuracy 1.0.
[2024-01-02 12:42:59,241][INFO] attacked test set accuracy 1.0.
[2024-01-02 12:42:59,249][INFO] Accuracy at every epoch: [0.9827]
[2024-01-02 12:42:59,249][INFO] After 0 epochs / 0m 4s (4.684 seconds), eventually the trained network got certified? False, with 0.9827 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-01-02 12:42:59,249][INFO] final test
[2024-01-02 12:42:59,252][INFO] --Test set accuracy 0.9827
[2024-01-02 12:42:59,256][INFO] --Test repair set accuracy 1.0
[2024-01-02 12:42:59,263][INFO] --Test attack test set accuracy 1.0
[2024-01-02 12:42:59,263][INFO] training time 4.705955471843481s
[2024-01-02 12:42:59,267][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2024-01-02 12:42:59,267][INFO] tensor([0.0000, 4.6841, 0.0000, 0.9827])
[2024-01-02 12:42:59,268][INFO] Total Cost Time: 84.08801429346204s.



