[2024-11-12 09:06:57,904][INFO] 
===== resnet18-8-feature-50-2024-11-12-09-06-57 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 0.0008
  lr: 1
  batch_size: 50
  min_epochs: 15
  max_epochs: 100
  use_scheduler: True
  no_pts: True
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: resnet18
  no_repair: False
  repair_number: 50
  repair_batchsize: 1
  repair_location: feature
  repair_radius: 8
  loose_bound: 0.0314
  divided_repair: 1
  accuracy_loss: <function CifarArgParser.setup_rest.<locals>.ce_loss at 0x7fdd8ceaab80>
  reset_params: False
  train_datasize: 10000
  test_datasize: 500
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  sample_amount: 1000
  repair_batch_size: 50
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7fddc57d3ee0>
===== end of resnet18-8-feature-50-2024-11-12-09-06-57 configuration =====

[2024-11-12 09:06:57,904][INFO] ===== start repair ======
[2024-11-12 09:06:57,904][INFO] For pgd attack net
[2024-11-12 09:06:58,698][INFO] --Test repair set accuracy 0.0
[2024-11-12 09:06:58,701][INFO] --Test original set accuracy 1.0
[2024-11-12 09:06:58,771][INFO] --Test test set accuracy 0.8833
[2024-11-12 09:06:58,775][INFO] --Test attack test set accuracy 0.004
[2024-11-12 09:06:58,844][INFO] --Test train set accuracy 0.9988
[2024-11-12 09:06:58,844][INFO] get the feature of the repairset, testset and trainset
[2024-11-12 09:06:59,198][INFO] sample the datas from the radius of the original data with pgd attack
[2024-11-12 09:06:59,198][INFO] --sample the 0 part of the originalset
[2024-11-12 09:06:59,198][INFO] --FGSM sample 1 image
[2024-11-12 09:06:59,641][INFO] --FGSM sample 2 image
[2024-11-12 09:07:00,082][INFO] --FGSM sample 3 image
[2024-11-12 09:07:00,530][INFO] --FGSM sample 4 image
[2024-11-12 09:07:00,974][INFO] --FGSM sample 5 image
[2024-11-12 09:07:01,419][INFO] --FGSM sample 6 image
[2024-11-12 09:07:01,864][INFO] --FGSM sample 7 image
[2024-11-12 09:07:02,313][INFO] --FGSM sample 8 image
[2024-11-12 09:07:02,762][INFO] --FGSM sample 9 image
[2024-11-12 09:07:03,208][INFO] --FGSM sample 10 image
[2024-11-12 09:07:03,657][INFO] --FGSM sample 11 image
[2024-11-12 09:07:04,106][INFO] --FGSM sample 12 image
[2024-11-12 09:07:04,554][INFO] --FGSM sample 13 image
[2024-11-12 09:07:05,002][INFO] --FGSM sample 14 image
[2024-11-12 09:07:05,450][INFO] --FGSM sample 15 image
[2024-11-12 09:07:05,895][INFO] --FGSM sample 16 image
[2024-11-12 09:07:06,342][INFO] --FGSM sample 17 image
[2024-11-12 09:07:06,790][INFO] --FGSM sample 18 image
[2024-11-12 09:07:07,237][INFO] --FGSM sample 19 image
[2024-11-12 09:07:07,684][INFO] --FGSM sample 20 image
[2024-11-12 09:07:08,132][INFO] --FGSM sample 21 image
[2024-11-12 09:07:08,581][INFO] --FGSM sample 22 image
[2024-11-12 09:07:09,025][INFO] --FGSM sample 23 image
[2024-11-12 09:07:09,471][INFO] --FGSM sample 24 image
[2024-11-12 09:07:09,918][INFO] --FGSM sample 25 image
[2024-11-12 09:07:10,366][INFO] --FGSM sample 26 image
[2024-11-12 09:07:10,809][INFO] --FGSM sample 27 image
[2024-11-12 09:07:11,254][INFO] --FGSM sample 28 image
[2024-11-12 09:07:11,700][INFO] --FGSM sample 29 image
[2024-11-12 09:07:12,146][INFO] --FGSM sample 30 image
[2024-11-12 09:07:12,588][INFO] --FGSM sample 31 image
[2024-11-12 09:07:13,036][INFO] --FGSM sample 32 image
[2024-11-12 09:07:13,484][INFO] --FGSM sample 33 image
[2024-11-12 09:07:13,932][INFO] --FGSM sample 34 image
[2024-11-12 09:07:14,380][INFO] --FGSM sample 35 image
[2024-11-12 09:07:17,020][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2024-11-12 09:07:17,020][INFO] --FGSM sample 36 image
[2024-11-12 09:07:17,470][INFO] --FGSM sample 37 image
[2024-11-12 09:07:17,914][INFO] --FGSM sample 38 image
[2024-11-12 09:07:19,240][INFO] --FGSM sample 39 image
[2024-11-12 09:07:21,887][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2024-11-12 09:07:21,887][INFO] --FGSM sample 40 image
[2024-11-12 09:07:22,333][INFO] --FGSM sample 41 image
[2024-11-12 09:07:22,783][INFO] --FGSM sample 42 image
[2024-11-12 09:07:23,227][INFO] --FGSM sample 43 image
[2024-11-12 09:07:25,870][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2024-11-12 09:07:25,871][INFO] --FGSM sample 44 image
[2024-11-12 09:07:26,316][INFO] --FGSM sample 45 image
[2024-11-12 09:07:26,763][INFO] --FGSM sample 46 image
[2024-11-12 09:07:27,211][INFO] --FGSM sample 47 image
[2024-11-12 09:07:27,660][INFO] --FGSM sample 48 image
[2024-11-12 09:07:28,105][INFO] --FGSM sample 49 image
[2024-11-12 09:07:28,551][INFO] --FGSM sample 50 image
[2024-11-12 09:07:29,127][INFO] --get the 0 part of the feature_lb and feature_ub
[2024-11-12 09:07:31,015][INFO] --Test repair set accuracy 0.0
[2024-11-12 09:07:31,081][INFO] --Patch network: --- feature PatchNet ---
Name: feature patch network 49
--- End of feature PatchNet ---
[2024-11-12 09:07:31,084][INFO] [0m 0s (0.001 seconds)] Start repair part 0: 0
[2024-11-12 09:07:31,084][INFO] [0m 0s (0.001 seconds)] After epoch 0:
[2024-11-12 09:07:31,084][INFO] Loaded 50 abstractions for training.
[2024-11-12 09:07:31,340][INFO] min loss 1.8140406608581543, max loss 394.96356201171875.
[2024-11-12 09:07:31,341][INFO] Max loss at rule: tensor([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:3', dtype=torch.uint8).
[2024-11-12 09:07:31,366][INFO] Test set accuracy 0.8833.
[2024-11-12 09:07:31,366][INFO] repair set accuracy 0.02.
[2024-11-12 09:07:31,366][INFO] attacked test set accuracy 0.024.
[2024-11-12 09:07:31,366][INFO] 
[0m 0s (0.283 seconds)] Starting epoch 1:
[2024-11-12 09:07:31,963][INFO] [0m 0s (0.881 seconds)] After epoch 1:
[2024-11-12 09:07:31,964][INFO] Loaded 50 abstractions for training.
[2024-11-12 09:07:32,223][INFO] min loss 0.0, max loss 37.436737060546875.
[2024-11-12 09:07:32,224][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:3', dtype=torch.uint8).
[2024-11-12 09:07:32,250][INFO] Test set accuracy 0.8833.
[2024-11-12 09:07:32,250][INFO] repair set accuracy 0.14.
[2024-11-12 09:07:32,250][INFO] attacked test set accuracy 0.234.
[2024-11-12 09:07:32,250][INFO] 
[0m 1s (1.167 seconds)] Starting epoch 2:
[2024-11-12 09:07:32,788][INFO] [0m 1s (1.705 seconds)] After epoch 2:
[2024-11-12 09:07:32,788][INFO] Loaded 50 abstractions for training.
[2024-11-12 09:07:33,052][INFO] min loss 0.0, max loss 25.4669189453125.
[2024-11-12 09:07:33,053][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:3', dtype=torch.uint8).
[2024-11-12 09:07:33,079][INFO] Test set accuracy 0.8833.
[2024-11-12 09:07:33,079][INFO] repair set accuracy 0.38.
[2024-11-12 09:07:33,079][INFO] attacked test set accuracy 0.462.
[2024-11-12 09:07:33,079][INFO] 
[0m 1s (1.996 seconds)] Starting epoch 3:
[2024-11-12 09:07:33,639][INFO] [0m 2s (2.556 seconds)] After epoch 3:
[2024-11-12 09:07:33,639][INFO] Loaded 50 abstractions for training.
[2024-11-12 09:07:33,903][INFO] min loss 0.0, max loss 18.34512710571289.
[2024-11-12 09:07:33,904][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:3', dtype=torch.uint8).
[2024-11-12 09:07:33,929][INFO] Test set accuracy 0.8833.
[2024-11-12 09:07:33,929][INFO] repair set accuracy 0.56.
[2024-11-12 09:07:33,929][INFO] attacked test set accuracy 0.634.
[2024-11-12 09:07:33,929][INFO] 
[0m 2s (2.847 seconds)] Starting epoch 4:
[2024-11-12 09:07:34,467][INFO] [0m 3s (3.385 seconds)] After epoch 4:
[2024-11-12 09:07:34,468][INFO] Loaded 50 abstractions for training.
[2024-11-12 09:07:34,729][INFO] min loss 0.0, max loss 15.566305160522461.
[2024-11-12 09:07:34,729][INFO] Max loss at rule: tensor([0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:3', dtype=torch.uint8).
[2024-11-12 09:07:34,755][INFO] Test set accuracy 0.8833.
[2024-11-12 09:07:34,755][INFO] repair set accuracy 0.68.
[2024-11-12 09:07:34,755][INFO] attacked test set accuracy 0.77.
[2024-11-12 09:07:34,755][INFO] 
[0m 3s (3.673 seconds)] Starting epoch 5:
[2024-11-12 09:07:35,291][INFO] [0m 4s (4.209 seconds)] After epoch 5:
[2024-11-12 09:07:35,292][INFO] Loaded 50 abstractions for training.
[2024-11-12 09:07:35,554][INFO] min loss 0.0, max loss 13.849283218383789.
[2024-11-12 09:07:35,554][INFO] Max loss at rule: tensor([0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:3', dtype=torch.uint8).
[2024-11-12 09:07:35,580][INFO] Test set accuracy 0.8833.
[2024-11-12 09:07:35,580][INFO] repair set accuracy 0.92.
[2024-11-12 09:07:35,580][INFO] attacked test set accuracy 0.954.
[2024-11-12 09:07:35,580][INFO] 
[0m 4s (4.498 seconds)] Starting epoch 6:
[2024-11-12 09:07:36,118][INFO] [0m 5s (5.035 seconds)] After epoch 6:
[2024-11-12 09:07:36,118][INFO] Loaded 50 abstractions for training.
[2024-11-12 09:07:36,381][INFO] min loss 0.0, max loss 12.19412899017334.
[2024-11-12 09:07:36,382][INFO] Max loss at rule: tensor([0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:3', dtype=torch.uint8).
[2024-11-12 09:07:36,407][INFO] Test set accuracy 0.8833.
[2024-11-12 09:07:36,407][INFO] repair set accuracy 1.0.
[2024-11-12 09:07:36,407][INFO] attacked test set accuracy 0.992.
[2024-11-12 09:07:36,408][INFO] 
[0m 5s (5.325 seconds)] Starting epoch 7:
[2024-11-12 09:07:36,947][INFO] [0m 5s (5.864 seconds)] After epoch 7:
[2024-11-12 09:07:36,947][INFO] Loaded 50 abstractions for training.
[2024-11-12 09:07:37,216][INFO] min loss 0.0, max loss 10.585927963256836.
[2024-11-12 09:07:37,217][INFO] Max loss at rule: tensor([0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:3', dtype=torch.uint8).
[2024-11-12 09:07:37,243][INFO] Test set accuracy 0.8833.
[2024-11-12 09:07:37,243][INFO] repair set accuracy 1.0.
[2024-11-12 09:07:37,243][INFO] attacked test set accuracy 1.0.
[2024-11-12 09:07:37,302][INFO] Accuracy at every epoch: [0.8833, 0.8833, 0.8833, 0.8833, 0.8833, 0.8833, 0.8833, 0.8833]
[2024-11-12 09:07:37,302][INFO] After 7 epochs / 0m 6s (6.160 seconds), eventually the trained network got certified? False, with 0.8833 accuracy on test set,with 1.0000 accuracy on repair set,with 1.0000 accuracy on attack test set.
[2024-11-12 09:07:37,302][INFO] final test
[2024-11-12 09:07:37,304][INFO] --Test set accuracy 0.8833
[2024-11-12 09:07:37,316][INFO] --Test repair set accuracy 1.0
[2024-11-12 09:07:37,329][INFO] --Test attack test set accuracy 1.0
[2024-11-12 09:07:37,329][INFO] traing time 6.246081050951034s
[2024-11-12 09:07:37,340][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2024-11-12 09:07:37,340][INFO] tensor([7.0000, 6.1600, 0.0000, 0.8833])
[2024-11-12 09:07:37,340][INFO] Total Cost Time: 39.43701022188179s.



