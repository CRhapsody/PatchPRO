[2023-12-23 03:17:19,160][INFO] 
===== resnet18-4-feature-100-2023-12-23-03-17-19 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 0.0004
  lr: 10
  batch_size: 50
  min_epochs: 15
  max_epochs: 100
  use_scheduler: True
  no_pts: True
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: resnet18
  no_repair: False
  repair_number: 100
  repair_batchsize: 1
  repair_location: feature
  repair_radius: 4
  loose_bound: 0.0314
  divided_repair: 1
  weight_decay: 0.0
  k_coeff: 0.001
  accuracy_loss: <function CifarArgParser.setup_rest.<locals>.ce_loss at 0x7f7f1dca9430>
  support_loss: MSELoss()
  sample_amount: 1000
  reset_params: False
  train_datasize: 10000
  test_datasize: 1000
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 100
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7f7f1dca9310>
===== end of resnet18-4-feature-100-2023-12-23-03-17-19 configuration =====

[2023-12-23 03:17:19,160][INFO] ===== start repair ======
[2023-12-23 03:17:19,160][INFO] For pgd attack net
[2023-12-23 03:17:19,840][INFO] --Test repair set accuracy 0.0
[2023-12-23 03:17:19,843][INFO] --Test original set accuracy 0.99
[2023-12-23 03:17:19,936][INFO] --Test test set accuracy 0.8833
[2023-12-23 03:17:19,946][INFO] --Test attack test set accuracy 0.004
[2023-12-23 03:17:20,038][INFO] --Test train set accuracy 0.9988
[2023-12-23 03:17:20,038][INFO] get the feature of the repairset, testset and trainset
[2023-12-23 03:17:20,306][INFO] sample the datas from the radius of the original data with pgd attack
[2023-12-23 03:17:20,306][INFO] --sample the 0 part of the originalset
[2023-12-23 03:17:20,307][INFO] --FGSM sample 1 image
[2023-12-23 03:17:20,739][INFO] --PGD sample 1 image
[2023-12-23 03:17:25,188][INFO] --FGSM sample 2 image
[2023-12-23 03:17:25,635][INFO] --PGD sample 2 image
[2023-12-23 03:17:30,332][INFO] --FGSM sample 3 image
[2023-12-23 03:17:30,795][INFO] --PGD sample 3 image
[2023-12-23 03:17:35,451][INFO] --FGSM sample 4 image
[2023-12-23 03:17:35,960][INFO] --PGD sample 4 image
[2023-12-23 03:17:40,514][INFO] --FGSM sample 5 image
[2023-12-23 03:17:40,952][INFO] --PGD sample 5 image
[2023-12-23 03:17:45,408][INFO] --FGSM sample 6 image
[2023-12-23 03:17:45,850][INFO] --PGD sample 6 image
[2023-12-23 03:17:50,239][INFO] --FGSM sample 7 image
[2023-12-23 03:17:50,698][INFO] --PGD sample 7 image
[2023-12-23 03:17:55,162][INFO] --FGSM sample 8 image
[2023-12-23 03:17:55,614][INFO] --PGD sample 8 image
[2023-12-23 03:18:00,104][INFO] --FGSM sample 9 image
[2023-12-23 03:18:00,525][INFO] --PGD sample 9 image
[2023-12-23 03:18:04,895][INFO] --FGSM sample 10 image
[2023-12-23 03:18:05,364][INFO] --PGD sample 10 image
[2023-12-23 03:18:09,923][INFO] --FGSM sample 11 image
[2023-12-23 03:18:10,385][INFO] --PGD sample 11 image
[2023-12-23 03:18:14,736][INFO] --FGSM sample 12 image
[2023-12-23 03:18:15,187][INFO] --PGD sample 12 image
[2023-12-23 03:18:19,554][INFO] --FGSM sample 13 image
[2023-12-23 03:18:20,010][INFO] --PGD sample 13 image
[2023-12-23 03:18:24,432][INFO] --FGSM sample 14 image
[2023-12-23 03:18:24,875][INFO] --PGD sample 14 image
[2023-12-23 03:18:29,258][INFO] --FGSM sample 15 image
[2023-12-23 03:18:29,703][INFO] --PGD sample 15 image
[2023-12-23 03:18:34,065][INFO] --FGSM sample 16 image
[2023-12-23 03:18:34,503][INFO] --PGD sample 16 image
[2023-12-23 03:18:38,801][INFO] --FGSM sample 17 image
[2023-12-23 03:18:39,283][INFO] --PGD sample 17 image
[2023-12-23 03:18:43,620][INFO] --FGSM sample 18 image
[2023-12-23 03:18:44,077][INFO] --PGD sample 18 image
[2023-12-23 03:18:48,547][INFO] --FGSM sample 19 image
[2023-12-23 03:18:49,004][INFO] --PGD sample 19 image
[2023-12-23 03:18:53,784][INFO] --FGSM sample 20 image
[2023-12-23 03:18:54,253][INFO] --PGD sample 20 image
[2023-12-23 03:18:58,982][INFO] --FGSM sample 21 image
[2023-12-23 03:18:59,477][INFO] --PGD sample 21 image
[2023-12-23 03:19:04,252][INFO] --FGSM sample 22 image
[2023-12-23 03:19:04,738][INFO] --PGD sample 22 image
[2023-12-23 03:19:09,629][INFO] --FGSM sample 23 image
[2023-12-23 03:19:10,119][INFO] --PGD sample 23 image
[2023-12-23 03:19:14,868][INFO] --FGSM sample 24 image
[2023-12-23 03:19:15,374][INFO] --PGD sample 24 image
[2023-12-23 03:19:20,021][INFO] --FGSM sample 25 image
[2023-12-23 03:19:20,474][INFO] --PGD sample 25 image
[2023-12-23 03:19:24,940][INFO] --FGSM sample 26 image
[2023-12-23 03:19:25,471][INFO] --PGD sample 26 image
[2023-12-23 03:19:29,866][INFO] --FGSM sample 27 image
[2023-12-23 03:19:32,523][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 03:19:32,523][INFO] --PGD sample 27 image
[2023-12-23 03:19:36,782][INFO] --FGSM sample 28 image
[2023-12-23 03:19:37,230][INFO] --PGD sample 28 image
[2023-12-23 03:19:41,684][INFO] --FGSM sample 29 image
[2023-12-23 03:19:42,142][INFO] --PGD sample 29 image
[2023-12-23 03:19:46,602][INFO] --FGSM sample 30 image
[2023-12-23 03:19:47,046][INFO] --PGD sample 30 image
[2023-12-23 03:19:51,553][INFO] --FGSM sample 31 image
[2023-12-23 03:19:52,023][INFO] --PGD sample 31 image
[2023-12-23 03:19:56,695][INFO] --FGSM sample 32 image
[2023-12-23 03:19:57,174][INFO] --PGD sample 32 image
[2023-12-23 03:20:01,657][INFO] --FGSM sample 33 image
[2023-12-23 03:20:02,111][INFO] --PGD sample 33 image
[2023-12-23 03:20:06,661][INFO] --FGSM sample 34 image
[2023-12-23 03:20:07,107][INFO] --PGD sample 34 image
[2023-12-23 03:20:11,651][INFO] --FGSM sample 35 image
[2023-12-23 03:20:12,119][INFO] --PGD sample 35 image
[2023-12-23 03:20:16,686][INFO] --FGSM sample 36 image
[2023-12-23 03:20:17,168][INFO] --PGD sample 36 image
[2023-12-23 03:20:21,868][INFO] --FGSM sample 37 image
[2023-12-23 03:20:22,348][INFO] --PGD sample 37 image
[2023-12-23 03:20:27,473][INFO] --FGSM sample 38 image
[2023-12-23 03:20:27,937][INFO] --PGD sample 38 image
[2023-12-23 03:20:32,851][INFO] --FGSM sample 39 image
[2023-12-23 03:20:33,321][INFO] --PGD sample 39 image
[2023-12-23 03:20:38,137][INFO] --FGSM sample 40 image
[2023-12-23 03:20:38,598][INFO] --PGD sample 40 image
[2023-12-23 03:20:43,114][INFO] --FGSM sample 41 image
[2023-12-23 03:20:43,569][INFO] --PGD sample 41 image
[2023-12-23 03:20:48,097][INFO] --FGSM sample 42 image
[2023-12-23 03:20:50,816][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 03:20:50,816][INFO] --PGD sample 42 image
[2023-12-23 03:20:55,477][INFO] --FGSM sample 43 image
[2023-12-23 03:20:55,972][INFO] --PGD sample 43 image
[2023-12-23 03:21:00,671][INFO] --FGSM sample 44 image
[2023-12-23 03:21:01,148][INFO] --PGD sample 44 image
[2023-12-23 03:21:06,156][INFO] --FGSM sample 45 image
[2023-12-23 03:21:06,594][INFO] --PGD sample 45 image
[2023-12-23 03:21:11,117][INFO] --FGSM sample 46 image
[2023-12-23 03:21:11,558][INFO] --PGD sample 46 image
[2023-12-23 03:21:16,388][INFO] --FGSM sample 47 image
[2023-12-23 03:21:16,815][INFO] --PGD sample 47 image
[2023-12-23 03:21:21,166][INFO] --FGSM sample 48 image
[2023-12-23 03:21:21,593][INFO] --PGD sample 48 image
[2023-12-23 03:21:26,014][INFO] --FGSM sample 49 image
[2023-12-23 03:21:26,455][INFO] --PGD sample 49 image
[2023-12-23 03:21:31,116][INFO] --FGSM sample 50 image
[2023-12-23 03:21:33,779][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 03:21:33,779][INFO] --PGD sample 50 image
[2023-12-23 03:21:38,273][INFO] --FGSM sample 51 image
[2023-12-23 03:21:38,745][INFO] --PGD sample 51 image
[2023-12-23 03:21:43,287][INFO] --FGSM sample 52 image
[2023-12-23 03:21:45,680][INFO] --PGD sample 52 image
[2023-12-23 03:21:50,872][INFO] --FGSM sample 53 image
[2023-12-23 03:21:53,658][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 03:21:53,658][INFO] --PGD sample 53 image
[2023-12-23 03:21:58,124][INFO] --FGSM sample 54 image
[2023-12-23 03:21:58,577][INFO] --PGD sample 54 image
[2023-12-23 03:22:03,022][INFO] --FGSM sample 55 image
[2023-12-23 03:22:03,461][INFO] --PGD sample 55 image
[2023-12-23 03:22:07,864][INFO] --FGSM sample 56 image
[2023-12-23 03:22:08,313][INFO] --PGD sample 56 image
[2023-12-23 03:22:12,836][INFO] --FGSM sample 57 image
[2023-12-23 03:22:13,353][INFO] --PGD sample 57 image
[2023-12-23 03:22:17,970][INFO] --FGSM sample 58 image
[2023-12-23 03:22:20,659][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 03:22:20,659][INFO] --PGD sample 58 image
[2023-12-23 03:22:25,612][INFO] --FGSM sample 59 image
[2023-12-23 03:22:26,073][INFO] --PGD sample 59 image
[2023-12-23 03:22:30,572][INFO] --FGSM sample 60 image
[2023-12-23 03:22:31,028][INFO] --PGD sample 60 image
[2023-12-23 03:22:35,501][INFO] --FGSM sample 61 image
[2023-12-23 03:22:35,967][INFO] --PGD sample 61 image
[2023-12-23 03:22:40,456][INFO] --FGSM sample 62 image
[2023-12-23 03:22:40,918][INFO] --PGD sample 62 image
[2023-12-23 03:22:45,441][INFO] --FGSM sample 63 image
[2023-12-23 03:22:48,176][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 03:22:48,176][INFO] --PGD sample 63 image
[2023-12-23 03:22:52,571][INFO] --FGSM sample 64 image
[2023-12-23 03:22:53,014][INFO] --PGD sample 64 image
[2023-12-23 03:22:57,501][INFO] --FGSM sample 65 image
[2023-12-23 03:22:57,966][INFO] --PGD sample 65 image
[2023-12-23 03:23:02,646][INFO] --FGSM sample 66 image
[2023-12-23 03:23:03,132][INFO] --PGD sample 66 image
[2023-12-23 03:23:07,944][INFO] --FGSM sample 67 image
[2023-12-23 03:23:08,410][INFO] --PGD sample 67 image
[2023-12-23 03:23:12,982][INFO] --FGSM sample 68 image
[2023-12-23 03:23:13,440][INFO] --PGD sample 68 image
[2023-12-23 03:23:18,281][INFO] --FGSM sample 69 image
[2023-12-23 03:23:18,781][INFO] --PGD sample 69 image
[2023-12-23 03:23:23,299][INFO] --FGSM sample 70 image
[2023-12-23 03:23:23,784][INFO] --PGD sample 70 image
[2023-12-23 03:23:28,310][INFO] --FGSM sample 71 image
[2023-12-23 03:23:28,756][INFO] --PGD sample 71 image
[2023-12-23 03:23:33,148][INFO] --FGSM sample 72 image
[2023-12-23 03:23:33,598][INFO] --PGD sample 72 image
[2023-12-23 03:23:37,939][INFO] --FGSM sample 73 image
[2023-12-23 03:23:38,400][INFO] --PGD sample 73 image
[2023-12-23 03:23:42,872][INFO] --FGSM sample 74 image
[2023-12-23 03:23:43,329][INFO] --PGD sample 74 image
[2023-12-23 03:23:48,045][INFO] --FGSM sample 75 image
[2023-12-23 03:23:48,526][INFO] --PGD sample 75 image
[2023-12-23 03:23:52,872][INFO] --FGSM sample 76 image
[2023-12-23 03:23:53,325][INFO] --PGD sample 76 image
[2023-12-23 03:23:57,654][INFO] --FGSM sample 77 image
[2023-12-23 03:23:58,096][INFO] --PGD sample 77 image
[2023-12-23 03:24:02,567][INFO] --FGSM sample 78 image
[2023-12-23 03:24:03,017][INFO] --PGD sample 78 image
[2023-12-23 03:24:07,388][INFO] --FGSM sample 79 image
[2023-12-23 03:24:07,838][INFO] --PGD sample 79 image
[2023-12-23 03:24:12,310][INFO] --FGSM sample 80 image
[2023-12-23 03:24:12,764][INFO] --PGD sample 80 image
[2023-12-23 03:24:17,266][INFO] --FGSM sample 81 image
[2023-12-23 03:24:17,724][INFO] --PGD sample 81 image
[2023-12-23 03:24:22,127][INFO] --FGSM sample 82 image
[2023-12-23 03:24:22,568][INFO] --PGD sample 82 image
[2023-12-23 03:24:27,032][INFO] --FGSM sample 83 image
[2023-12-23 03:24:27,472][INFO] --PGD sample 83 image
[2023-12-23 03:24:31,988][INFO] --FGSM sample 84 image
[2023-12-23 03:24:32,450][INFO] --PGD sample 84 image
[2023-12-23 03:24:36,895][INFO] --FGSM sample 85 image
[2023-12-23 03:24:37,389][INFO] --PGD sample 85 image
[2023-12-23 03:24:42,192][INFO] --FGSM sample 86 image
[2023-12-23 03:24:42,650][INFO] --PGD sample 86 image
[2023-12-23 03:24:47,128][INFO] --FGSM sample 87 image
[2023-12-23 03:24:47,594][INFO] --PGD sample 87 image
[2023-12-23 03:24:52,220][INFO] --FGSM sample 88 image
[2023-12-23 03:24:52,710][INFO] --PGD sample 88 image
[2023-12-23 03:24:57,528][INFO] --FGSM sample 89 image
[2023-12-23 03:24:58,078][INFO] --PGD sample 89 image
[2023-12-23 03:25:02,653][INFO] --FGSM sample 90 image
[2023-12-23 03:25:03,108][INFO] --PGD sample 90 image
[2023-12-23 03:25:08,000][INFO] --FGSM sample 91 image
[2023-12-23 03:25:08,595][INFO] --PGD sample 91 image
[2023-12-23 03:25:13,309][INFO] --FGSM sample 92 image
[2023-12-23 03:25:13,797][INFO] --PGD sample 92 image
[2023-12-23 03:25:18,620][INFO] --FGSM sample 93 image
[2023-12-23 03:25:19,045][INFO] --PGD sample 93 image
[2023-12-23 03:25:23,679][INFO] --FGSM sample 94 image
[2023-12-23 03:25:24,128][INFO] --PGD sample 94 image
[2023-12-23 03:25:28,632][INFO] --FGSM sample 95 image
[2023-12-23 03:25:29,068][INFO] --PGD sample 95 image
[2023-12-23 03:25:33,633][INFO] --FGSM sample 96 image
[2023-12-23 03:25:34,096][INFO] --PGD sample 96 image
[2023-12-23 03:25:38,737][INFO] --FGSM sample 97 image
[2023-12-23 03:25:39,204][INFO] --PGD sample 97 image
[2023-12-23 03:25:43,833][INFO] --FGSM sample 98 image
[2023-12-23 03:25:46,567][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 03:25:46,567][INFO] --PGD sample 98 image
[2023-12-23 03:25:51,049][INFO] --FGSM sample 99 image
[2023-12-23 03:25:51,517][INFO] --PGD sample 99 image
[2023-12-23 03:25:56,048][INFO] --FGSM sample 100 image
[2023-12-23 03:25:56,532][INFO] --PGD sample 100 image
[2023-12-23 03:26:01,910][INFO] --get the 0 part of the feature_lb and feature_ub
[2023-12-23 03:26:03,299][INFO] --Test repair set accuracy 0.0
[2023-12-23 03:26:03,320][INFO] --Patch network: --- feature PatchNet ---
Name: feature patch network 99
--- End of feature PatchNet ---
[2023-12-23 03:26:03,322][INFO] [0m 0s (0.000 seconds)] Start repair part 0: 0
[2023-12-23 03:26:03,322][INFO] [0m 0s (0.001 seconds)] After epoch 0:
[2023-12-23 03:26:03,322][INFO] Loaded 100 abstractions for training.
[2023-12-23 03:26:03,475][INFO] min loss 0.7858157753944397, max loss 26.84705352783203.
[2023-12-23 03:26:03,476][INFO] Max loss at rule: tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 1], device='cuda:2', dtype=torch.uint8).
[2023-12-23 03:26:03,539][INFO] Test set accuracy 0.8833.
[2023-12-23 03:26:03,539][INFO] repair set accuracy 0.03.
[2023-12-23 03:26:03,539][INFO] train set accuracy 0.9989.
[2023-12-23 03:26:03,539][INFO] attacked test set accuracy 0.039.
[2023-12-23 03:26:03,539][INFO] 
[0m 0s (0.218 seconds)] Starting epoch 1:
[2023-12-23 03:26:03,954][INFO] [0m 0s (0.633 seconds)] After epoch 1:
[2023-12-23 03:26:03,954][INFO] Loaded 100 abstractions for training.
[2023-12-23 03:26:04,106][INFO] min loss 0.0, max loss 0.0.
[2023-12-23 03:26:04,106][INFO] All 100 abstractions certified.
[2023-12-23 03:26:04,169][INFO] Test set accuracy 0.8833.
[2023-12-23 03:26:04,169][INFO] repair set accuracy 1.0.
[2023-12-23 03:26:04,169][INFO] train set accuracy 0.9989.
[2023-12-23 03:26:04,169][INFO] attacked test set accuracy 1.0.
[2023-12-23 03:26:04,192][INFO] Accuracy at every epoch: [0.8833, 0.8833]
[2023-12-23 03:26:04,192][INFO] After 1 epochs / 0m 0s (0.848 seconds), eventually the trained network got certified? True, with 0.8833 accuracy on test set,with 1.0000 accuracy on repair set,with 0.9989 accuracy on train set,with 1.0000 accuracy on attack test set.
[2023-12-23 03:26:04,192][INFO] final test
[2023-12-23 03:26:04,196][INFO] --Test set accuracy 0.8833
[2023-12-23 03:26:04,216][INFO] --Test repair set accuracy 1.0
[2023-12-23 03:26:04,237][INFO] --Test train set accuracy 0.9989
[2023-12-23 03:26:04,258][INFO] --Test attack test set accuracy 1.0
[2023-12-23 03:26:04,258][INFO] traing time 0.9365977831184864s
[2023-12-23 03:26:04,264][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2023-12-23 03:26:04,264][INFO] tensor([1.0000, 0.8480, 1.0000, 0.8833])
[2023-12-23 03:26:04,264][INFO] Total Cost Time: 525.1050062403083s.



