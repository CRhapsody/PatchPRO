[2023-12-23 05:54:23,271][INFO] 
===== resnet18-8-feature-50-2023-12-23-05-54-23 configuration =====
  exp_fn: test_goal_repair
  seed: None
  dom: deeppoly
  start_abs_cnt: 500
  max_abs_cnt: 1000
  refine_top_k: 50
  tiny_width: 0.0008
  lr: 10
  batch_size: 50
  min_epochs: 15
  max_epochs: 100
  use_scheduler: True
  no_pts: True
  no_abs: False
  no_refine: True
  quiet: False
  debug: False
  net: resnet18
  no_repair: False
  repair_number: 50
  repair_batchsize: 1
  repair_location: feature
  repair_radius: 8
  loose_bound: 0.0314
  divided_repair: 1
  weight_decay: 0.0
  k_coeff: 0.001
  accuracy_loss: <function CifarArgParser.setup_rest.<locals>.ce_loss at 0x7f7f1094cd30>
  support_loss: MSELoss()
  sample_amount: 1000
  reset_params: False
  train_datasize: 10000
  test_datasize: 500
  max_verifier_sec: 300
  verifier_timeout_as_safe: True
  repair_batch_size: 50
  scheduler_fn: <function ExpArgParser.setup_rest.<locals>.<lambda> at 0x7f7f1dce9e50>
===== end of resnet18-8-feature-50-2023-12-23-05-54-23 configuration =====

[2023-12-23 05:54:23,271][INFO] ===== start repair ======
[2023-12-23 05:54:23,271][INFO] For pgd attack net
[2023-12-23 05:54:23,944][INFO] --Test repair set accuracy 0.0
[2023-12-23 05:54:23,948][INFO] --Test original set accuracy 1.0
[2023-12-23 05:54:24,040][INFO] --Test test set accuracy 0.8833
[2023-12-23 05:54:24,045][INFO] --Test attack test set accuracy 0.004
[2023-12-23 05:54:24,137][INFO] --Test train set accuracy 0.9988
[2023-12-23 05:54:24,137][INFO] get the feature of the repairset, testset and trainset
[2023-12-23 05:54:24,354][INFO] sample the datas from the radius of the original data with pgd attack
[2023-12-23 05:54:24,355][INFO] --sample the 0 part of the originalset
[2023-12-23 05:54:24,355][INFO] --FGSM sample 1 image
[2023-12-23 05:54:24,824][INFO] --PGD sample 1 image
[2023-12-23 05:54:29,174][INFO] --FGSM sample 2 image
[2023-12-23 05:54:29,623][INFO] --PGD sample 2 image
[2023-12-23 05:54:34,041][INFO] --FGSM sample 3 image
[2023-12-23 05:54:34,492][INFO] --PGD sample 3 image
[2023-12-23 05:54:38,855][INFO] --FGSM sample 4 image
[2023-12-23 05:54:39,321][INFO] --PGD sample 4 image
[2023-12-23 05:54:43,801][INFO] --FGSM sample 5 image
[2023-12-23 05:54:44,266][INFO] --PGD sample 5 image
[2023-12-23 05:54:48,762][INFO] --FGSM sample 6 image
[2023-12-23 05:54:49,208][INFO] --PGD sample 6 image
[2023-12-23 05:54:53,616][INFO] --FGSM sample 7 image
[2023-12-23 05:54:54,081][INFO] --PGD sample 7 image
[2023-12-23 05:54:58,685][INFO] --FGSM sample 8 image
[2023-12-23 05:54:59,149][INFO] --PGD sample 8 image
[2023-12-23 05:55:03,634][INFO] --FGSM sample 9 image
[2023-12-23 05:55:04,088][INFO] --PGD sample 9 image
[2023-12-23 05:55:08,398][INFO] --FGSM sample 10 image
[2023-12-23 05:55:08,851][INFO] --PGD sample 10 image
[2023-12-23 05:55:13,551][INFO] --FGSM sample 11 image
[2023-12-23 05:55:14,040][INFO] --PGD sample 11 image
[2023-12-23 05:55:18,584][INFO] --FGSM sample 12 image
[2023-12-23 05:55:19,061][INFO] --PGD sample 12 image
[2023-12-23 05:55:23,578][INFO] --FGSM sample 13 image
[2023-12-23 05:55:24,030][INFO] --PGD sample 13 image
[2023-12-23 05:55:28,859][INFO] --FGSM sample 14 image
[2023-12-23 05:55:29,333][INFO] --PGD sample 14 image
[2023-12-23 05:55:34,102][INFO] --FGSM sample 15 image
[2023-12-23 05:55:34,606][INFO] --PGD sample 15 image
[2023-12-23 05:55:39,297][INFO] --FGSM sample 16 image
[2023-12-23 05:55:39,764][INFO] --PGD sample 16 image
[2023-12-23 05:55:44,193][INFO] --FGSM sample 17 image
[2023-12-23 05:55:44,650][INFO] --PGD sample 17 image
[2023-12-23 05:55:49,034][INFO] --FGSM sample 18 image
[2023-12-23 05:55:49,506][INFO] --PGD sample 18 image
[2023-12-23 05:55:54,587][INFO] --FGSM sample 19 image
[2023-12-23 05:55:55,047][INFO] --PGD sample 19 image
[2023-12-23 05:55:59,370][INFO] --FGSM sample 20 image
[2023-12-23 05:55:59,830][INFO] --PGD sample 20 image
[2023-12-23 05:56:04,182][INFO] --FGSM sample 21 image
[2023-12-23 05:56:04,641][INFO] --PGD sample 21 image
[2023-12-23 05:56:08,877][INFO] --FGSM sample 22 image
[2023-12-23 05:56:09,300][INFO] --PGD sample 22 image
[2023-12-23 05:56:14,211][INFO] --FGSM sample 23 image
[2023-12-23 05:56:14,753][INFO] --PGD sample 23 image
[2023-12-23 05:56:19,708][INFO] --FGSM sample 24 image
[2023-12-23 05:56:20,162][INFO] --PGD sample 24 image
[2023-12-23 05:56:24,870][INFO] --FGSM sample 25 image
[2023-12-23 05:56:25,320][INFO] --PGD sample 25 image
[2023-12-23 05:56:29,750][INFO] --FGSM sample 26 image
[2023-12-23 05:56:30,209][INFO] --PGD sample 26 image
[2023-12-23 05:56:34,622][INFO] --FGSM sample 27 image
[2023-12-23 05:56:35,066][INFO] --PGD sample 27 image
[2023-12-23 05:56:39,491][INFO] --FGSM sample 28 image
[2023-12-23 05:56:39,946][INFO] --PGD sample 28 image
[2023-12-23 05:56:44,415][INFO] --FGSM sample 29 image
[2023-12-23 05:56:44,868][INFO] --PGD sample 29 image
[2023-12-23 05:56:49,312][INFO] --FGSM sample 30 image
[2023-12-23 05:56:49,777][INFO] --PGD sample 30 image
[2023-12-23 05:56:54,973][INFO] --FGSM sample 31 image
[2023-12-23 05:56:55,431][INFO] --PGD sample 31 image
[2023-12-23 05:56:59,917][INFO] --FGSM sample 32 image
[2023-12-23 05:57:00,357][INFO] --PGD sample 32 image
[2023-12-23 05:57:04,875][INFO] --FGSM sample 33 image
[2023-12-23 05:57:05,338][INFO] --PGD sample 33 image
[2023-12-23 05:57:09,763][INFO] --FGSM sample 34 image
[2023-12-23 05:57:10,226][INFO] --PGD sample 34 image
[2023-12-23 05:57:15,336][INFO] --FGSM sample 35 image
[2023-12-23 05:57:18,172][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 05:57:18,172][INFO] --PGD sample 35 image
[2023-12-23 05:57:23,312][INFO] --FGSM sample 36 image
[2023-12-23 05:57:23,811][INFO] --PGD sample 36 image
[2023-12-23 05:57:28,682][INFO] --FGSM sample 37 image
[2023-12-23 05:57:29,160][INFO] --PGD sample 37 image
[2023-12-23 05:57:34,191][INFO] --FGSM sample 38 image
[2023-12-23 05:57:37,030][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 05:57:37,030][INFO] --PGD sample 38 image
[2023-12-23 05:57:41,646][INFO] --FGSM sample 39 image
[2023-12-23 05:57:44,380][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 05:57:44,380][INFO] --PGD sample 39 image
[2023-12-23 05:57:48,852][INFO] --FGSM sample 40 image
[2023-12-23 05:57:49,292][INFO] --PGD sample 40 image
[2023-12-23 05:57:53,716][INFO] --FGSM sample 41 image
[2023-12-23 05:57:54,171][INFO] --PGD sample 41 image
[2023-12-23 05:57:58,600][INFO] --FGSM sample 42 image
[2023-12-23 05:57:59,051][INFO] --PGD sample 42 image
[2023-12-23 05:58:03,745][INFO] --FGSM sample 43 image
[2023-12-23 05:58:06,596][INFO] --The attack_datas is empty, we use the repair data as the attack data
[2023-12-23 05:58:06,596][INFO] --PGD sample 43 image
[2023-12-23 05:58:11,355][INFO] --FGSM sample 44 image
[2023-12-23 05:58:11,827][INFO] --PGD sample 44 image
[2023-12-23 05:58:16,312][INFO] --FGSM sample 45 image
[2023-12-23 05:58:16,770][INFO] --PGD sample 45 image
[2023-12-23 05:58:21,512][INFO] --FGSM sample 46 image
[2023-12-23 05:58:21,978][INFO] --PGD sample 46 image
[2023-12-23 05:58:26,652][INFO] --FGSM sample 47 image
[2023-12-23 05:58:27,071][INFO] --PGD sample 47 image
[2023-12-23 05:58:31,555][INFO] --FGSM sample 48 image
[2023-12-23 05:58:31,982][INFO] --PGD sample 48 image
[2023-12-23 05:58:36,546][INFO] --FGSM sample 49 image
[2023-12-23 05:58:36,999][INFO] --PGD sample 49 image
[2023-12-23 05:58:41,776][INFO] --FGSM sample 50 image
[2023-12-23 05:58:42,283][INFO] --PGD sample 50 image
[2023-12-23 05:58:47,011][INFO] --get the 0 part of the feature_lb and feature_ub
[2023-12-23 05:58:47,448][INFO] --Test repair set accuracy 0.0
[2023-12-23 05:58:47,460][INFO] --Patch network: --- feature PatchNet ---
Name: feature patch network 49
--- End of feature PatchNet ---
[2023-12-23 05:58:47,461][INFO] [0m 0s (0.000 seconds)] Start repair part 0: 0
[2023-12-23 05:58:47,461][INFO] [0m 0s (0.000 seconds)] After epoch 0:
[2023-12-23 05:58:47,461][INFO] Loaded 50 abstractions for training.
[2023-12-23 05:58:47,547][INFO] min loss 1.0824460983276367, max loss 60.39265060424805.
[2023-12-23 05:58:47,548][INFO] Max loss at rule: tensor([0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0], device='cuda:2', dtype=torch.uint8).
[2023-12-23 05:58:47,580][INFO] Test set accuracy 0.8833.
[2023-12-23 05:58:47,580][INFO] repair set accuracy 0.0.
[2023-12-23 05:58:47,580][INFO] train set accuracy 0.9988.
[2023-12-23 05:58:47,580][INFO] attacked test set accuracy 0.0.
[2023-12-23 05:58:47,580][INFO] 
[0m 0s (0.119 seconds)] Starting epoch 1:
[2023-12-23 05:58:47,815][INFO] [0m 0s (0.354 seconds)] After epoch 1:
[2023-12-23 05:58:47,815][INFO] Loaded 50 abstractions for training.
[2023-12-23 05:58:47,895][INFO] min loss 0.0, max loss 0.0.
[2023-12-23 05:58:47,895][INFO] All 50 abstractions certified.
[2023-12-23 05:58:47,931][INFO] Test set accuracy 0.8833.
[2023-12-23 05:58:47,931][INFO] repair set accuracy 1.0.
[2023-12-23 05:58:47,931][INFO] train set accuracy 0.9988.
[2023-12-23 05:58:47,931][INFO] attacked test set accuracy 1.0.
[2023-12-23 05:58:47,937][INFO] Accuracy at every epoch: [0.8833, 0.8833]
[2023-12-23 05:58:47,937][INFO] After 1 epochs / 0m 0s (0.470 seconds), eventually the trained network got certified? True, with 0.8833 accuracy on test set,with 1.0000 accuracy on repair set,with 0.9988 accuracy on train set,with 1.0000 accuracy on attack test set.
[2023-12-23 05:58:47,937][INFO] final test
[2023-12-23 05:58:47,940][INFO] --Test set accuracy 0.8833
[2023-12-23 05:58:47,949][INFO] --Test repair set accuracy 1.0
[2023-12-23 05:58:47,961][INFO] --Test train set accuracy 0.9988
[2023-12-23 05:58:47,971][INFO] --Test attack test set accuracy 1.0
[2023-12-23 05:58:47,971][INFO] traing time 0.5099193230271339s
[2023-12-23 05:58:47,976][INFO] === Avg <epochs, train_time, certified, accuracy> for pgd attack networks:
[2023-12-23 05:58:47,976][INFO] tensor([1.0000, 0.4700, 1.0000, 0.8833])
[2023-12-23 05:58:47,977][INFO] Total Cost Time: 264.7061668410897s.



